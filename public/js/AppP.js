(function(){var t,e,i,n,s,r,o;s=function(t,e){if(t<e){return e}else{return t}};n=function(t,e){if(t>e){return e}else{return t}};r=function(t,e,i){if(t<e){return e}else if(t>i){return i}else{return t}};i=function(i){var t,e,n;t={};for(e in i){n=i[e];t[e]=n}return t};o=function(t){var e;while((e=t.firstChild)!=null){t.removeChild(e)}};t=function(){function t(t,e,i,n){this.x0=t;this.x1=e;this.y0=i;this.y1=n;this.a=(this.y1-this.y0)/(this.x1-this.x0);this.b=this.y0-this.a*this.x0}t.prototype.y=function(t){return this.a*t+this.b};return t}();e=function(){function t(t,e,i,n){this.x0=t;this.x1=e;this.y0=i;this.y1=n;this.a=(this.y1-this.y0)/(this.x1-this.x0);this.b=this.y0-this.a*this.x0}t.prototype.y=function(t){if(t<this.x0){return this.y0}else if(t>this.x1){return this.y1}else{return this.a*t+this.b}};return t}();window.MiscUtils={limitMin:s,limitMax:n,limitMinMax:r,cloneObject:i,removeChildren:o,LinMap:t,LinMapLimitX:e}}).call(this);(function(){var e,m,i,t,n,N,x,V,H,I,h,v,p,c,f,d,y,r,g,w,u,D,a,A,o,b,T,M,_,s,C,L,S,P,l;r=Math.floor;h=Math.ceil;o=Math.round;n=1e3;t=60*n;i=60*t;e=24*i;N=7*e;m=[[31,28,31,30,31,30,31,31,30,31,30,31],[31,29,31,30,31,30,31,31,30,31,30,31]];a=function(t){return t%400===0||t%100!==0&&t%4===0};y=function(t){if(a(t)){return 366}else{return 365}};d=function(t,e){return m[Number(a(t))][e-1]};x=function(t,e,i){return new Date(t,e-1,i)};V=function(t,e,i,n){return new Date(t,e-1,i,n)};H=function(t,e,i,n,s){return new Date(t,e-1,i,n,s)};I=function(t,e,i,n,s,r){return new Date(t,e-1,i,n,s,r)};A=function(e){var t;if($.type(e)!=="string"){return}t=e.match(/^(\d{4})-(\d\d)-(\d\d)$/);if(t==null){return}return x(parseInt(t[1]),parseInt(t[2]),parseInt(t[3]))};D=function(t){return new Date(r(+t/n)*n)};f=function(t){return new Date(h(+t/n)*n)};_=function(t){return new Date(o(+t/n)*n)};u=function(e){return new Date(r(+e/t)*t)};c=function(e){return new Date(h(+e/t)*t)};M=function(e){return new Date(o(+e/t)*t)};w=function(n){var e;e=n.getTimezoneOffset()*t;return new Date(r((+n-e)/i)*i+e)};p=function(n){var e;e=n.getTimezoneOffset()*t;return new Date(h((+n-e)/i)*i+e)};T=function(n){var e;e=n.getTimezoneOffset()*t;return new Date(o((+n-e)/i)*i+e)};g=function(n){var i;i=n.getTimezoneOffset()*t;return new Date(r((+n-i)/e)*e+i)};v=function(n){var i;i=n.getTimezoneOffset()*t;return new Date(h((+n-i)/e)*e+i)};b=function(n){var i;i=n.getTimezoneOffset()*t;return new Date(o((+n-i)/e)*e+i)};l=function(t,e){return t.year()===e.year()};S=function(t,e){return t.year()===e.year()&&t.mon()===e.mon()};C=function(t,e){return t.year()===e.year()&&t.mon()===e.mon()&&t.day()===e.day()};L=function(t,e){return t.year()===e.year()&&t.mon()===e.mon()&&t.day()===e.day()&&t.hour()===e.hour()};P=function(t,e){return t.year()===e.year()&&t.mon()===e.mon()&&t.day()===e.day()&&t.hour()===e.hour()&&t.sec()===e.sec()};Date.SEC=n;Date.MIN=t;Date.HOUR=i;Date.DAY=e;Date.WEEK=N;Date.DAYS_OF_MON=m;Date.isLeapYear=a;Date.daysOfYear=y;Date.daysOfMon=d;Date.YMD=x;Date.YMDH=V;Date.YMDHM=H;Date.YMDHMS=I;Date.iso8601=A;Date.floorSec=D;Date.ceilSec=f;Date.roundSec=_;Date.floorMin=u;Date.ceilMin=c;Date.roundMin=M;Date.floorHour=w;Date.ceilHour=p;Date.roundHour=T;Date.floorDay=g;Date.ceilDay=v;Date.roundDay=b;Date.sameYear=l;Date.sameMon=S;Date.sameDay=C;Date.sameHour=L;Date.prototype.sameSec=P;Date.prototype.year=Date.prototype.getFullYear;Date.prototype.mon=function(){return this.getMonth()+1};Date.prototype.wday=Date.prototype.getDay;Date.prototype.day=Date.prototype.getDate;Date.prototype.hour=Date.prototype.getHours;Date.prototype.min=Date.prototype.getMinutes;Date.prototype.sec=Date.prototype.getSeconds;Date.prototype.msec=Date.prototype.getMilliseconds;Date.prototype.isLeapYear=function(){return a(this.year())};Date.prototype.daysOfYear=function(){return y(this.year())};Date.prototype.daysOfMon=function(){return d(this.year(),this.mon())};Date.prototype.floorDay=function(){return g(this)};Date.prototype.ceilDay=function(){return v(this)};Date.prototype.roundDay=function(){return b(this)};Date.prototype.floorHour=function(){return w(this)};Date.prototype.ceilHour=function(){return p(this)};Date.prototype.roundHour=function(){return T(this)};Date.prototype.floorMin=function(){return u(this)};Date.prototype.ceilMin=function(){return c(this)};Date.prototype.roundMin=function(){return M(this)};Date.prototype.floorSec=function(){return D(this)};Date.prototype.ceilSec=function(){return f(this)};Date.prototype.roundSec=function(){return _(this)};Date.prototype.nextYear=function(i){var e,t,n;if(i==null){i=1}t=new Date(+this);t.setDate(1);t.setFullYear(this.year()+i);e=this.day();n=t.daysOfMon();if(e>n){e=n}t.setDate(e);return t};Date.prototype.prevYear=function(t){if(t==null){t=1}return this.nextYear(-t)};Date.prototype.nextMon=function(i){var e,t,n;if(i==null){i=1}t=new Date(+this);t.setDate(1);t.setMonth(this.getMonth()+i);e=this.day();n=t.daysOfMon();if(e>n){e=n}t.setDate(e);return t};Date.prototype.prevMon=function(t){if(t==null){t=1}return this.nextMon(-t)};Date.prototype.nextDay=function(e){var t;if(e==null){e=1}t=new Date(+this);t.setDate(t.getDate()+e);return t};Date.prototype.prevDay=function(t){if(t==null){t=1}return this.nextDay(-t)};Date.prototype.nextHour=function(t){if(t==null){t=1}return Date.YMDH(this.year(),this.mon(),this.day(),this.hour()+t)};Date.prototype.prevHour=function(t){if(t==null){t=1}return this.nextHour(-t)};Date.prototype.nextMin=function(t){if(t==null){t=1}return Date.YMDHM(this.year(),this.mon(),this.day(),this.hour(),this.min()+t)};Date.prototype.prevMin=function(t){if(t==null){t=1}return this.nextHour(-t)};Date.prototype.nextSec=function(t){if(t==null){t=1}return Date.YMDHMS(this.year(),this.mon(),this.day(),this.hour(),this.min(),this.sec+t)};Date.prototype.prevSec=function(t){if(t==null){t=1}return this.nextHour(-t)};Date.prototype.sameYear=function(t){return l(this,t)};Date.prototype.sameMon=function(t){return S(this,t)};Date.prototype.sameDay=function(t){return C(this,t)};Date.prototype.sameHour=function(t){return L(this,t)};Date.prototype.sameSec=function(t){return P(this,t)};s=function(t){if(t<10){return"0"+t}else{return""+t}};Date.prototype.toString=function(){var e,t;t=this.getTimezoneOffset();if(t<0){t=-t;e="+"}else{e="-"}return""+this.year()+"-"+s(this.mon())+"-"+s(this.day())+" "+s(this.hour())+":"+s(this.sec())+":"+s(this.msec()/10<<0)+" ("+e+s(t/60<<0)+":"+s(t%60)+")"}}).call(this);(function(){var n,s,r,i,o,t,e;i=MiscUtils.limitMinMax;e=function(){var t;t=DataInfo.hourly.firstDay;return Date.YMDH(t.year(),t.mon(),t.day(),1)};t=function(){var t;t=DataInfo.hourly.lastDay;return Date.YMDH(t.year(),t.mon(),t.day(),24)};r=function(n){return i(n.floorHour(),e(),t())};s=function(n){return i(n.ceilHour(),e(),t())};o=function(n){return i(n.roundHour(),e(),t())};n=["北","北北東","北東","東北東","東","東南東","南東","南南東","南","南南西","南西","西南西","西","西北西","北西","北北西","静穏"];DataInfo.timeMin=e;DataInfo.timeMax=t;DataInfo.floorHour=r;DataInfo.ceilHour=s;DataInfo.roundHour=o;DataInfo.WIND_DIRECTION=n}).call(this);(function(){window.Pref={platform:"pc",W_GRADATION_DISPLAY:200,W_GRAPH_VIEW:520,H_GRAPH_VIEW:320}}).call(this);(function(){window.GoogleMapsDefaults={LatMin:-85,LatMax:85,LonMin:-180,LonMax:180,ZoomMin:1,ZoomMax:17,lat:37,lon:137,zoom:5,type:google.maps.MapTypeId.ROADMAP}}).call(this);(function(){var n,D,R,A,T,M,O,b,V,H,I,P,v,f,L,C,_,e,x,a,S,w,o,s,g,m,y,d,c,p,i,l,u,N,h,r,k={}.hasOwnProperty,t=function(t,e){for(var i in e){if(k.call(e,i))t[i]=e[i]}function n(){this.constructor=t}n.prototype=e.prototype;t.prototype=new n;t.__super__=e.prototype;return t};R="gmw-frame";M="gmw-row";H="gmw-subframe";I="gmw-subrow";A="gmw-hr";b="gmw-spacer-";L="gmw-text";V={normal:"gmw-static-n",grayed:"gmw-static-g"};D={regular:{normal:"gmw-button-r-n",grayed:"gmw-button-r-g",pressed:"gmw-button-r-p"},highlight:{normal:"gmw-button-h-n",grayed:"gmw-button-h-g",pressed:"gmw-button-h-p"}};T={left:{regular:{normal:"gmw-radio-l-r-n",grayed:"gmw-radio-l-r-g",pressed:"gmw-radio-l-r-p"},highlight:{normal:"gmw-radio-l-h-n",grayed:"gmw-radio-l-h-g",pressed:"gmw-radio-l-h-p"}},middle:{regular:{normal:"gmw-radio-m-r-n",grayed:"gmw-radio-m-r-g",pressed:"gmw-radio-m-r-p"},highlight:{normal:"gmw-radio-m-h-n",grayed:"gmw-radio-m-h-g",pressed:"gmw-radio-m-h-p"}},right:{regular:{normal:"gmw-radio-r-r-n",grayed:"gmw-radio-r-r-g",pressed:"gmw-radio-r-r-p"},highlight:{normal:"gmw-radio-r-h-n",grayed:"gmw-radio-r-h-g",pressed:"gmw-radio-r-h-p"}}};O="gmw-select";P="gmw-table";v="gmw-tbody";_="gmw-tr";C="gmw-th";f={left:{regular:"gmw-tdl",highlight:"gmw-tdl-h"},center:{regular:"gmw-tdc",highlight:"gmw-tdc-h"},right:{regular:"gmw-tdr",highlight:"gmw-tdr-h"}};e=function(){function t(i,t,e){this.elem=document.createElement(i);if(t!=null){t.appendChild(this.elem)}if(e!=null){this.setClass(e)}this.bounds={};this}t.prototype.getElement=function(){return this.elem};t.prototype.appendChild=function(e){if(e instanceof t){e=e.getElement()}this.elem.appendChild(e);return this};t.prototype.removeChild=function(e){if(e instanceof t){e=e.getElement()}this.elem.removeChild(e);return this};t.prototype.replaceChild=function(e,i){if(e instanceof t){e=e.getElement()}if(i instanceof t){i=i.getElement()}this.elem.replaceChild(e,i);return this};t.prototype.setClass=function(t){if(t!=null){this.elem.className=t}return this};t.prototype.addClass=function(e){var t;t=this.elem.className.split(" ");if(t.indexOf(e)===-1){t.push(e);this.elem.className=t.join(" ")}return this};t.prototype.removeClass=function(i){var t,e;t=this.elem.className.split(" ");if((e=t.indexOf(i))!==-1){t.splice(e,1);this.elem.className=t.join(" ")}return this};t.prototype.setText=function(t){if(t!=null){this.elem.innerHTML=t}return this};t.prototype.setTitle=function(t){if(t!=null){this.elem.title=t}return this};t.prototype.bind=function(t,e){if(!this.bounds[t]){this.bounds[t]=google.maps.event.addDomListener(this.elem,t,e)}return this};t.prototype.unbind=function(t){if(this.bounds[t]){google.maps.event.removeListener(this.bounds[t]);delete this.bounds[t]}return this};return t}();m=function(i){t(e,i);function e(t,i){e.__super__.constructor.call(this,"span",t,b+i)}return e}(e);r=function(i){t(e,i);function e(t,i){e.__super__.constructor.call(this,"span",t,i);this.stat="normal";this}e.prototype.state=function(){return this.stat};e.prototype.setState=function(t){this.stat=t;this.setClass(this.stateToClass()[this.stat]);return this};return e}(e);h=function(i){t(e,i);function e(t,i){e.__super__.constructor.call(this,"span",t,L);this.setText(i)}return e}(e);y=function(i){t(e,i);function e(i,t){e.__super__.constructor.apply(this,arguments);this.setText(t);this.setState("normal");this}e.prototype.stateToClass=function(){return V};return e}(r);n=function(i){t(e,i);function e(s,t,i,n){this.onClick=n;this.hi="regular";e.__super__.constructor.apply(this,arguments);this.elem.draggable=false;this.setText(t);this.setTitle(i);this.enable(true);this}e.prototype.highlight=function(){return this.hi};e.prototype.setHighlight=function(t){this.hi=t;this.setState(this.stat);return this};e.prototype.stateToClass=function(){return D[this.hi]};e.prototype.enable=function(t){if(t){this.bind("mousedown",function(t){return function(e){return t.mousedown(e)}}(this));this.bind("mouseout",function(t){return function(e){return t.mouseout(e)}}(this));this.bind("click",function(t){return function(e){return t.click(e)}}(this));this.setState("normal")}else{this.unbind("mousedown");this.unbind("mouseout");this.unbind("click");this.setState("grayed")}return this};e.prototype.mousedown=function(t){return this.setState("pressed")};e.prototype.mouseout=function(t){return this.setState("normal")};e.prototype.click=function(t){this.setState("normal");if(this.onClick!=null){return this.onClick(this)}};return e}(r);w=function(i){t(e,i);function e(t,i,n,s){this.style="middle";e.__super__.constructor.apply(this,arguments)}e.prototype.setStyle=function(t){this.style=t;return this};e.prototype.stateToClass=function(){return T[this.style][this.hi]};return e}(n);o=function(){function t(t,e){this.parent=t;this.handler=e;this.buttons=[];this.sel=null;this}t.prototype.bind=function(t){this.handler=t};t.prototype.add=function(i,t){var e;if(t==null){t=i}e=new w(this.parent,i,t,function(t){return function(e){return t.click(e)}}(this));e.index=this.buttons.length;this.buttons.push(e);return this};t.prototype.finalize=function(t){if(t==null){t=0}if(this.buttons.length<2){throw"RadioGroup: at least 2 buttons needed"}this.buttons[0].setStyle("left");this.buttons[this.buttons.length-1].setStyle("right");this.select(t);return this};t.prototype.click=function(t){this.select(t.index);if(this.handler){return this.handler(t.index)}};t.prototype.selected=function(){return this.sel};t.prototype.select=function(t){this.sel=t;return this.update()};t.prototype.update=function(){var i,t,e;for(i=t=0,e=this.buttons.length;0<=e?t<e:t>e;i=0<=e?++t:--t){this.buttons[i].setHighlight(i===this.sel?"highlight":"regular")}return this};t.prototype.enable=function(s){var i,t,n,e;e=this.buttons;for(t=0,n=e.length;t<n;t++){i=e[t];i.enable(s)}return this};return t}();S=function(i){t(e,i);function e(t,i,n){e.__super__.constructor.call(this,"option",t);this.setText(i);this.elem.value=n.toString();this}return e}(e);g=function(i){t(e,i);function e(i,t){e.__super__.constructor.call(this,"select",i,O);if(t){this.bind("change",t)}}e.prototype.options=function(){return this.elem.children};e.prototype.length=function(){return this.elem.children.length};e.prototype.clear=function(){this.elem.innerHTML="";return this};e.prototype.add=function(t,e){new S(this,t,e);return this};e.prototype.select=function(s){var i,n,t,e;s=s.toString();n=-1;for(i=t=0,e=this.elem.children.length;0<=e?t<e:t>e;i=0<=e?++t:--t){if(this.elem.children[i].value===s){n=i;break}}if(n!==-1){this.elem.selectedIndex=n}return this};e.prototype.enable=function(t){this.elem.disabled=!t;return this};e.prototype.value=function(t){if(t==null){t=null}if(t==null){t=this.elem.selectedIndex}return this.elem.children[t].value};return e}(e);l=function(i){t(e,i);function e(i,t){e.__super__.constructor.call(this,"th",i,C);if(t!=null){this.setText(t)}}return e}(e);i=function(i){t(e,i);function e(n,t,i){this.align=i!=null?i:"left";this.hi="regular";e.__super__.constructor.call(this,"td",n,f[this.align][this.hi]);if(t!=null){this.setText(t)}}e.prototype.highlight=function(){return this.hi};e.prototype.setHighlight=function(t){this.hi=t;return this.setClass(f[this.align][this.hi])};return e}(e);u=function(n){t(e,n);function e(t){e.__super__.constructor.call(this,"tr",t,_)}e.prototype.addTH=function(t){return new l(this,t)};e.prototype.addTD=function(t,e){return new i(this,t,e)};e.prototype.addTDL=function(t){return new i(this,t,"left")};e.prototype.addTDC=function(t){return new i(this,t,"center")};e.prototype.addTDR=function(t){return new i(this,t,"right")};return e}(e);p=function(i){t(e,i);function e(t){e.__super__.constructor.call(this,"tbody",t,v)}e.prototype.addTR=function(){var t;return t=new u(this)};return e}(e);N=function(i){t(e,i);function e(t){e.__super__.constructor.call(this,"table",t,P);this.tbody=new p(this)}e.prototype.addTR=function(){return this.tbody.addTR()};return e}(e);s=function(i){t(e,i);function e(t){e.__super__.constructor.call(this,"div",t,M)}e.prototype.addSpacer=function(t){return new m(this,t)};e.prototype.addText=function(t){return new h(this,t)};e.prototype.addStatic=function(t){return new y(this,t)};e.prototype.addButton=function(t,e,i){return new n(this,t,e,i)};e.prototype.addRadioGroup=function(t){return new o(this,t)};e.prototype.addSelect=function(t){return new g(this,t)};return e}(e);c=function(i){t(e,i);function e(t){e.__super__.constructor.apply(this,arguments);this.setClass(I)}return e}(s);a=function(i){t(e,i);function e(t){e.__super__.constructor.call(this,"div",t,A)}return e}(e);d=function(i){t(e,i);function e(t){e.__super__.constructor.call(this,"div",t,H)}e.prototype.addRow=function(){return new c(this)};e.prototype.addHR=function(){return new a(this)};e.prototype.addSubframe=function(){return new e(this)};return e}(e);x=function(i){t(e,i);function e(){e.__super__.constructor.call(this,null);this.setClass(R);this.bind("click",function(t){return t.stopPropagation()});this.bind("mousemove",function(t){return t.stopPropagation()})}e.prototype.addRow=function(){return new s(this)};return e}(d);window.GoogleMapsWidget={Element:e,Spacer:m,Widget:r,Static:y,Text:h,Button:n,RadioButton:w,RadioGroup:o,Select:g,Table:N,TBody:p,TR:u,TH:l,TD:i,Row:s,Subrow:c,HR:a,Subframe:d,Frame:x}}).call(this);(function(){var t;t=function(){function t(t){this.data=t.split(",")}t.prototype.get_i=function(){var t;t=this.data.shift();if(t.length===0){return null}else{return parseInt(t)}};t.prototype.get_f=function(){var t;t=this.data.shift();if(t.length===0){return null}else{return parseFloat(t)}};return t}();window.CsvParser=t}).call(this);(function(){var e,i,s,r,t,n,o;e="data/datainfo";i=60*60*1e3;s=1*60*1e3;r=function(){function t(){this.handlers=[]}t.prototype.add=function(t){return this.handlers.push(t)};t.prototype.notify=function(){var n,t,s,e,i;e=this.handlers;i=[];for(t=0,s=e.length;t<s;t++){n=e[t];i.push(n())}return i};return t}();n=new r;o=function(o){var e,t,i,u,s,r,h,a;a=o.split("\n");for(r=0,h=a.length;r<h;r++){u=a[r];if((s=o.match(/firstdayhourly:\s*(.*)/))!=null){e=Date.iso8601(s[1])}if((s=o.match(/lastdayhourly:\s*(.*)/))!=null){i=Date.iso8601(s[1])}}if(e!=null&&i!=null){t=DataInfo.hourly;if(e<t.firstDay||t.lastDay<i){t.firstDay=e;t.lastDay=i;return n.notify()}}};t=function(){var n;n=$.get(e);n.done(function(e){return function(e){o(e);return setTimeout(t,i)}}(this));return n.fail(function(i){return function(i){console.log(""+new Date+": Cannot load: "+e);return setTimeout(t,s)}}(this))};setTimeout(t,i);window.UpdateChecker={add:function(t){return n.add(t)}}}).call(this);(function(){var h,a,u,l,p,c,o,r,t,i,n,e,s,f,d;r=MiscUtils.cloneObject;p=/(.+)=(.*)/;i=window.location;e=function(o,t){var s,i,e,r,n;if(t==null){t={}}n=o.toLowerCase().split("&");for(e=0,r=n.length;e<r;e++){s=n[e];if((i=s.match(p))!=null){t[i[1]]=i[2]}}return t};s=function(t){if(t==null){t={}}return e(i.search.substring(1),t)};n=function(t){if(t==null){t={}}return e(i.hash.substring(1),t)};f=function(t){if(t==null){t={}}return n(s(t))};t=window.GoogleMapsDefaults;a=t.LatMin;h=t.LatMax;l=t.LonMin;u=t.LonMax;o=t.ZoomMin;c=t.ZoomMax;d=function(y,e){var d,i,n,s,p,f;if(e==null){e=r(t)}for(d in y){p=y[d];switch(d){case"ll":n=p.split(",");if(n.length===2){i=parseFloat(n[0]);s=parseFloat(n[1]);if(a<=i&&i<=h&&(l<=s&&s<=u)){e.lat=i;e.lon=s}}break;case"z":f=parseInt(p);if(o<=f&&f<=c){e.zoom=f}break;case"t":e.type=p}}return e};window.OptionParser={parseOption:e,parseQuery:s,parseHash:n,parseUrlOption:f,processGoogleMapsOption:d}}).call(this);(function(){var i,n,t,e;i=100;t={};e=[];n=function(){function n(t){this.ctl=t}n.prototype.getData=function(s,r){var n,i;i=this.key(s,r/6>>0);n=t[i];if(this.isData(n)){e.splice(e.indexOf(i),1);e.push(i)}return n};n.prototype.isData=function(t){return $.type(t)==="string"};n.prototype.isFetching=function(t){return t!=null&&$.type(t)!=="string"};n.prototype.xhr=function(s,r){var o,n,a;o=r/6>>0;n=this.key(s,o);if(t[n]!=null){this.getData(s(r));return}t[n]=a=$.get(this.path(s,o));a.done(function(o){return function(a){t[n]=a;if(e.length>=i){delete t[e.shift()]}e.push(n);return o.ctl.xhrDone(s,r,a)}}(this));return a.fail(function(e){return function(i){delete t[n];return e.ctl.xhrFail(s,r,i)}}(this))};n.prototype.sNN=function(t){if(t<10){return"0"+t}else{return""+t}};n.prototype.key=function(t,e){return""+t.year()+"-"+t.mon()+"-"+t.day()+"-"+e};n.prototype.path=function(t,e){return"data/hourly/map/"+t.year()+"/"+this.sNN(t.mon())+this.sNN(t.day())+"/"+e+".csv"};return n}();window.WeatherModel=n}).call(this);(function(){var t,e;t=6;e=function(){function e(){}e.prototype.decode=function(v){var l,r,y,i,g,w,h,u,a,p,c,f,d,n,e,s,o,m;e=new CsvParser(v);r=function(){var e,i;i=[];for(f=e=0;0<=t?e<t:e>t;f=0<=t?++e:--e){i.push({})}return i}();n=e.get_i();for(y=s=0;0<=n?s<n:s>n;y=0<=n?++s:--s){d=e.get_i();i=e.get_i();u=(i&1)!==0;p=(i&2)!==0;c=(i&4)!==0;g=(i&8)!==0;h=(i&16)!==0;w=(i&32)!==0;a=(i&64)!==0;for(o=0,m=r.length;o<m;o++){l=r[o];l[d]=[u?e.get_f():null,p?e.get_f():null,c?e.get_f():null,g?e.get_i():null,h?e.get_f():null,w?e.get_i():null,a?e.get_i():null]}}return r};return e}();window.WeatherDecoder=e}).call(this);(function(){var t;t=function(){function t(t){if(t==null){t=null}this.model=new WeatherModel(this);this.views=[];this.decoder=new WeatherDecoder;this.day=null;this.hour=null;this.xhrDay=this.xhrHour=null;this.data=null;this.interval=null;this.timer=null;this.firstDay=DataInfo.hourly.firstDay;this.lastDay=DataInfo.hourly.lastDay;UpdateChecker.add(function(t){return function(){return t.onUpdateData()}}(this));if(t!=null){this.addView(t)}}t.prototype.addView=function(t){if(this.views.indexOf(t)===-1){this.views.push(t)}};t.prototype.removeView=function(e){var t;if((t=this.views.indexOf(e))!==-1){this.views.splice(t,1)}};t.prototype.getData=function(){if(this.data!=null){return this.data[this.hour%6]}else{return null}};t.prototype.isLastData=function(){return this.isSameData(this.lastDay,23)};t.prototype.isLastFrame=function(){return this.isLastData()&&this.hour===23};t.prototype.getTime=function(){if(this.day){return Date.YMDH(this.day.year(),this.day.mon(),this.day.day(),this.hour+1)}};t.prototype.setTime=function(t){var e;if($.type(t)==="number"){t=new Date(t)}t=DataInfo.ceilHour(t);e=Date.YMDH(t.year(),t.mon(),t.day(),t.hour()-1);this.requestData(e,e.hour())};t.prototype.prefetchNextData=function(){var t,e;if(!this.isLastData()){t=this.day;e=this.hour+6;if(e>=24){e-=24;t=t.nextDay()}if(this.model.getData(t,e)==null){this.model.xhr(t,e)}}};t.prototype.xhrDone=function(t,e,i){if(this.xhrDay!=null&&this.xhrDay.sameDay(t)&&this.xhrHour===e){this.setNewData(t,e,i);if(this.interval){this.setAnim(this.interval,true)}}};t.prototype.xhrFail=function(t,e,i){this.updateViews(false)};t.prototype.onUpdateData=function(){var i,t,n,e;this.firstDay=DataInfo.hourly.firstDay;this.lastDay=DataInfo.hourly.lastDay;e=this.views;for(t=0,n=e.length;t<n;t++){i=e[t];i.onUpdateData()}};t.prototype.setAnim=function(e,t){if(t==null){t=false}if(!t&&this.interval===e){return}this.interval=e;if(this.timer!=null){clearTimeout(this.timer)}if(this.interval!=null){this.prefetchNextData();this.timer=setTimeout(function(t){return function(){return t.onTimer()}}(this),this.interval)}else{this.timer=null}};t.prototype.onTimer=function(){var i,e,t;e=this.day;t=this.hour+1;if(t%6!==0){this.hour=t;this.updateViews(true);if(this.isLastFrame()){this.interval=this.timer=null;return}}else{if(t===24){t=0;e=e.nextDay()}i=this.model.getData(e,t);if(this.model.isData(i)){this.setNewData(e,t,i);this.prefetchNextData()}}this.timer=setTimeout(function(t){return function(){return t.onTimer()}}(this),this.interval)};t.prototype.isSameData=function(t,e){return this.day!=null&&this.day.sameDay(t)&&this.hour/6>>0===e/6>>0};t.prototype.requestData=function(e,t){var i;if(this.isSameData(e,t)){if(this.hour!==t){this.hour=t;this.updateViews(true);if(this.interval){this.setAnim(this.interval,true)}}return}i=this.model.getData(e,t);if(this.model.isData(i)){this.setNewData(e,t,i);if(this.interval){this.setAnim(this.interval,true)}}else if(!this.model.isFetching(i)){this.xhrDay=e;this.xhrHour=t;this.model.xhr(e,t)}};t.prototype.setNewData=function(t,e,i){this.day=t;this.hour=e;this.xhrDay=this.xhrHour=null;this.data=this.decoder.decode(i);this.updateViews(true)};t.prototype.updateViews=function(s){var i,t,n,e;e=this.views;for(t=0,n=e.length;t<n;t++){i=e[t];i.update(this,s)}};return t}();window.WeatherController=t}).call(this);(function(){var s,i,n,t,e;s=100;t={};e=[];i={y:"",d:"x",c:"xx"};n=function(){function n(t){this.ctl=t}n.prototype.getData=function(s,r,o){var n,i;i=this.key(s,r,o);n=t[i];if(this.isData(n)){e.splice(e.indexOf(i),1);e.push(i)}return n};n.prototype.isData=function(t){return $.type(t)==="string"};n.prototype.isFetching=function(t){return t!=null&&$.type(t)!=="string"};n.prototype.xhr=function(n,r,o){var i,a;i=this.key(n,r,o);if(t[i]!=null){this.getData(n,r,o);return}t[i]=a=$.get(this.path(n,r,o));a.done(function(a){return function(h){t[i]=h;if(e.length>=s){delete t[e.shift()]}e.push(i);return a.ctl.xhrDone(n,r,o,h)}}(this));a.fail(function(e){return function(s){delete t[i];return e.ctl.xhrFail(n,r,o,s)}}(this))};n.prototype.key=function(t,n,e){if(e==="a"){return""+t+"-all"}else{return""+t+"-"+n+i[e]}};n.prototype.path=function(t,n,e){if(e==="a"){return"data/hourly/trend/all/"+t+".csv"}else{return"data/hourly/trend/"+n+i[e]+"/"+t+".csv"}};return n}();n.TYPE_POSTFIX=i;window.TrendModel=n}).call(this);(function(){var t,o,n,s,r,e,a,i;s=Math.ceil;a=function(t,e){if(t!=null){if(e!=null){if(t<e){return t}else{return e}}else{return t}}else{return e}};e=function(t,e){if(t!=null){if(e!=null){if(t>e){return t}else{return e}}else{return t}}else{return e}};t=[36e5,72e5,144e5,288e5,432e5,864e5,1728e5,3456e5,6912e5,13824e5,27648e5,55296e5,110592e5];r=Date.daysOfYear;i=function(i,e){var n,s,t;n=0;for(s=t=i;i<=e?t<=e:t>=e;s=i<=e?++t:--t){n+=r(s)}return n};o=s(i(1800,2099)/32);n=function(){function n(){}n.prototype.decode=function(e,i,t){switch(i){case"y":return this.decodeYear(e,t);case"d":return this.decodeDecade(e,t);case"c":return this.decodeCentury(e,t);case"a":return this.decodeAll(t)}};n.prototype.decodeYear=function(o,a){var e,i,n,s,r;s=+Date.YMDH(o,1,1,1);e=this.decodeY(o,a);e.t0=s;e.dt=t[0];n=[e];for(i=r=1;r<=3;i=++r){n.push(e=this.makeStat(e));e.t0=s;e.dt=t[i]}return n};n.prototype.decodeDecade=function(h,u){var e,n,s,o,r,a;r=h*10;o=+Date.YMDH(r,1,1,1);e=this.decodeDCA(i(r,r+9)*2,u);e.t0=o;e.dt=t[4];s=[];s[4]=e;for(n=a=5;a<=6;n=++a){s[n]=e=this.makeStat(e);e.t0=o;e.dt=t[n]}return s};n.prototype.decodeCentury=function(u,l){var e,n,r,a,o,h;o=u*100;a=+Date.YMDH(o,1,1,1);e=this.decodeDCA(s(i(o,o+99)/4),l);e.t0=a;e.dt=t[7];r=[];r[7]=e;for(n=h=8;h<=9;n=++h){r[n]=e=this.makeStat(e);e.t0=a;e.dt=t[n]}return r};n.prototype.decodeAll=function(a){var e,i,n,s,r;e=this.decodeDCA(o,a);s=+Date.YMDH(1800,1,1,1);e.t0=s;e.dt=t[10];n=[];n[10]=e;for(i=r=11;r<=12;i=++r){n[i]=e=this.makeStat(e);e.t0=s;e.dt=t[i]}return n};n.prototype.decodeY=function(v,w){var t,p,d,y,m,g,u,l,s,c,f,o,n,a,h,e,i;t=new CsvParser(w);e=this.parseFlags(t.get_i()),m=e[0],u=e[1],l=e[2],p=e[3],y=e[4],d=e[5],g=e[6];o=[];for(c=n=0,i=r(v);0<=i?n<i:n>i;c=0<=i?++n:--n){if(t.get_i()!=null){for(s=a=0;a<24;s=++a){o.push([m?t.get_f():null,f=u?t.get_f():null,f,l?t.get_f():null,p?t.get_i():null,y?t.get_f():null,d?t.get_i():null,g?t.get_i():null])}}else{for(s=h=0;h<24;s=++h){o.push(null)}}}return o};n.prototype.decodeDCA=function(n,f){var t,p,l,o,a,c,r,h,u,s,i,e;t=new CsvParser(f);e=this.parseFlags(t.get_i()),a=e[0],r=e[1],h=e[2],p=e[3],o=e[4],l=e[5],c=e[6];s=[];for(u=i=0;0<=n?i<n:i>n;u=0<=n?++i:--i){if(t.get_i()!=null){s.push([a?t.get_f():null,r?t.get_f():null,r?t.get_f():null,h?t.get_f():null,p?t.get_i():null,o?t.get_f():null,l?t.get_i():null,c?t.get_i():null])}else{s.push(null)}}return s};n.prototype.parseFlags=function(t){return[(t&1)!==0,(t&2)!==0,(t&4)!==0,(t&8)!==0,(t&16)!==0,(t&32)!==0,(t&64)!==0]};n.prototype.makeStat=function(l){var r,f,p,d,m,s,c,x,b,T,M,n,y,_,g,w,v,D,o,h,u,i,t;n=[];c=l.length;s=0;while(s<c){if(s===c-1){n.push(l[s]);return n}else{i=l[s];t=l[s+1];if(i!=null){if(t!=null){T=i[0],g=i[1],v=i[2],h=i[3],f=i[4],x=i[5],d=i[6],y=i[7];M=t[0],w=t[1],D=t[2],u=t[3],p=t[4],b=t[5],m=t[6],_=t[7];o=r=null;if(h!=null){if(u!=null){if(h>u){o=h;r=f}else{o=u;r=p}}else{o=h;r=f}}else{o=u;r=p}n.push([e(T,M),a(g,w),e(v,D),o,r,e(x,b),e(d,m),e(y,_)])}else{n.push(i)}}else{n.push(t)}s+=2}}return n};return n}();n.DELTA_TIME=t;window.TrendDecoder=n}).call(this);(function(){var t,e,i;t=function(){function t(t,e,i,n){this.id=t;this.level=e;this.tL=i;this.tR=n;this.t=this.x=null}t.prototype.reset=function(){};t.prototype.next=function(){};return t}();e=function(){function t(t,e,i,n,s,r,o){this.id=t;this.level=e;this.tL=i;this.tR=n;this.d=s;this.iL=r;this.iR=o;this.dt=this.d.dt;this.hasData=true;this.reset()}t.prototype.reset=function(){this.i=this.iL;this.x=this.d[this.iL];return this.t=this.d.t0+this.i*this.dt};t.prototype.next=function(){if(this.i!==this.iR){this.x=this.d[++this.i];return this.t+=this.dt}else{return this.t=this.x=null}};return t}();i=function(){function t(t,e,i,n,s,r,o,a){this.id=t;this.level=e;this.tL=i;this.tR=n;this.dL=s;this.iL=r;this.dR=o;this.iR=a;this.dt=this.dL.dt;this.hasData=true;this.reset()}t.prototype.reset=function(){this.d=this.dL;this.i=this.iL;this.x=this.d[this.i];return this.t=this.d.t0+this.i*this.dt};t.prototype.next=function(){if(this.d===this.dL){if(++this.i!==this.d.length){this.x=this.d[this.i];return this.t+=this.dt}else{this.d=this.dR;this.i=0;this.x=this.d[0];return this.t=this.d.t0}}else{if(this.i!==this.iR){this.x=this.d[++this.i];return this.t+=this.dt}else{return this.t=this.x=null}}};return t}();window.TrendIterator0=t;window.TrendIterator1=e;window.TrendIterator2=i}).call(this);(function(){var l,r,u,o,n,s,e,p,a,h,i,t;e=Math.ceil;p=Math.floor;h=MiscUtils.limitMin;a=MiscUtils.limitMax;i=MiscUtils.limitMinMax;l=50;n={};t=[];s=function(t,i,e){if(e==="a"){return""+t+"-all"}else{return""+t+"-"+i+u[e]}};u=TrendModel.TYPE_POSTFIX;r=TrendDecoder.DELTA_TIME;o=function(){function o(t){if(t==null){t=null}this.model=new TrendModel(this);this.views=[];this.decoder=new TrendDecoder;UpdateChecker.add(function(t){return function(){return t.onUpdateData()}}(this));if(t!=null){this.addView(t)}}o.prototype.addView=function(t){if(this.views.indexOf(t)===-1){return this.views.push(t)}};o.prototype.removeView=function(e){var t;if((t=this.views.indexOf(e))!==-1){return this.views.splice(t,1)}};o.prototype.requestData=function(o,e,i,a){var s,n,t;if($.type(e)==="number"){e=new Date(e)}if($.type(i)==="number"){i=new Date(i)}this.pending=t={id:o,tL:e,tR:i};s=(i-e)/a;n=r.length-1;while(n!==0&&r[n]>s){--n}t.level=n;e=e.ceilHour().prevHour();i=i.ceilHour().prevHour();if(n<4){t.ty="y";t.iL=e.year();t.iR=i.year()}else if(n<7){t.ty="d";t.iL=e.year()/10>>0;t.iR=i.year()/10>>0}else if(n<10){t.ty="c";t.iL=e.year()/100>>0;t.iR=i.year()/100>>0}else{t.ty="a";t.iL=t.iR=0}return this.resolvePending()};o.prototype.xhrDone=function(t,e,i,n){this.setNewData(t,e,i,n);this.resolvePending()};o.prototype.xhrFail=function(t,e,i,n){if(n.status===404){this.rescuePending(t,e,i)}else{this.updateViews(false)}};o.prototype.onUpdateData=function(){var i,t,n,e;e=this.views;for(t=0,n=e.length;t<n;t++){i=e[t];i.onUpdateData()}};o.prototype.resolvePending=function(t){var e,i;if(t==null){t=this.pending}if(t!=null&&(e=this.getData(t.id,t.iL,t.ty))!=null){i=t.iL===t.iR?e:this.getData(t.id,t.iR,t.ty);if(i!=null){this.setIterator(e,i)}}};o.prototype.rescuePending=function(i,e,n,t){if(t==null){t=this.pending}if(t!=null&&i===t.id&&n===t.ty){if(e===t.iL){if(t.iL===t.iR){this.setIterator(null)}else{t.iL=t.iR;this.resolvePending()}}else if(e===t.iR){t.iR=t.iL;this.resolvePending()}}};o.prototype.getData=function(e,i,r){var a,h,o;o=s(e,i,r);if((a=n[o])!=null){t.splice(t.indexOf(o),1);t.push(o)}else if((h=this.model.getData(e,i,r))!=null){if(this.model.isData(h)){a=this.setNewData(e,i,r,h)}}else{this.model.xhr(e,i,r)}return a};o.prototype.setIterator=function(n,s,t){var o,r,l,u;if(t==null){t=this.pending}this.iterator=n!=null?(l=h(t.tL,DataInfo.timeMin()),u=a(t.tR,DataInfo.timeMax()),n=n[t.level],o=i(e((l-n.t0)/n.dt),0,n.length-1),t.iL===t.iR?(r=i(e((u-n.t0)/n.dt),0,n.length-1),new TrendIterator1(t.id,t.level,t.tL,t.tR,n,o,r)):(s=s[t.level],r=i(e((u-s.t0)/s.dt),0,s.length-1),new TrendIterator2(t.id,t.level,t.tL,t.tR,n,o,s,r))):new TrendIterator0(t.id,t.level,t.tL,t.tR);this.pending=null;this.updateViews(true)};o.prototype.setNewData=function(a,i,r,h){var o,e;e=s(a,i,r);o=n[e]=this.decoder.decode(i,r,h);if(t.length>=l){delete n[t.shift()]}t.push(e);return o};o.prototype.updateViews=function(s){var i,t,n,e;
e=this.views;for(t=0,n=e.length;t<n;t++){i=e[t];i.update(this,s)}};return o}();window.TrendController=o}).call(this);(function(){var e,i,n,s,t,r={}.hasOwnProperty,o=function(t,e){for(var i in e){if(r.call(e,i))t[i]=e[i]}function n(){this.constructor=t}n.prototype=e.prototype;t.prototype=new n;t.__super__=e.prototype;return t};window.SVGNS=t="http://www.w3.org/2000/svg";i=new google.maps.LatLng(0,-90);n=new google.maps.LatLng(0,90);s=/matrix\(.*,\s*(-?\d+),\s*(-?\d+)\)/;e=function(r){o(e,r);function e(t,e,i,n,s,r){this.canvasId=t;this.map=e;this.setMap(this.map);this.nwBound=new google.maps.LatLng(i,s);this.seBound=new google.maps.LatLng(n,r)}e.prototype.onAdd=function(){var e,i;this.div=document.createElement("div");this.div.style.border="none";this.div.style.borderWidth="0px";this.div.style.position="absolute";this.svg=document.createElementNS(t,"svg");this.svg.setAttribute("version","1.1");this.svg.setAttribute("xmlns",t);this.div.appendChild(this.svg);i=this.getPanes().overlayLayer;i.appendChild(this.div);this.dragDiv=i.parentNode;e=document.getElementById(this.canvasId);e.onclick=function(t){return function(e){return t.click(e)}}(this);e.onmousemove=function(t){return function(e){return t.mousemove(e)}}(this);return this};e.prototype.draw=function(){var o,a,t,s,r,e;this.zoom=this.map.getZoom();t=this.getProjection();o=t.fromLatLngToDivPixel(i);a=t.fromLatLngToDivPixel(n);this.pxEarthW=Math.abs(a.x-o.x)*2;this.origin=t.fromLatLngToDivPixel(this.nwBound);s=t.fromLatLngToDivPixel(this.seBound);e=s.x-this.origin.x;if(e<0){e+=this.pxEarthW}this.svg.setAttribute("width",""+e);this.svg.setAttribute("height",""+(s.y-this.origin.y));r=this.div.style;r.left=""+this.origin.x+"px";r.top=""+this.origin.y+"px";return this};e.prototype.click=function(t){return this.onClick(this.convertMouseCoord(t))};e.prototype.mousemove=function(t){return this.onMouseMove(this.convertMouseCoord(t))};e.prototype.onClick=function(t){};e.prototype.onMouseMove=function(t){};e.prototype.convertMouseCoord=function(r){var t,e,i,n;n=this.dragDiv.style["transform"];if(n!=null&&(i=n.match(s))!=null){t=parseInt(i[1]);e=parseInt(i[2])}else{t=parseInt(this.dragDiv.style.left);e=parseInt(this.dragDiv.style.top)}return new google.maps.Point(r.clientX-t,r.clientY-e)};return e}(google.maps.OverlayView);window.GoogleMapsOverlaySvg=e}).call(this);(function(){var n,i,a,p,l,s,r,v,o,f,y,h,u,T,d,P,m,g,e,c,D,x,b,t,M,_,C,L,S,w;e=function(n,s,e){var r,t,i;n/=s;i=[];for(r=t=0;0<=e?t<=e:t>=e;r=0<=e?++t:--t){i.push(n*=s)}return i};n=22;g=e(.14,1.45,n);d=e(.15,1.7,n);w=e(.012,1.7,n);M=function(){var t;t=e(1,1.6,3);t.unshift(0);return t}();P="rgba(0,0,0,0.5)";m="rgba(0,0,0,0.25)";t=Math.round;D=Math.log;o=function(){var e,c,m,y,r,d,a,h,f,g,p,s,w,n,i,l,u,o;s=[{t:-50,r:0,g:0,b:0},{t:-45,r:0,g:0,b:25},{t:-40,r:0,g:0,b:50},{t:-35,r:0,g:0,b:75},{t:-30,r:0,g:0,b:90},{t:-25,r:0,g:0,b:100},{t:-20,r:20,g:20,b:100},{t:-15,r:40,g:40,b:100},{t:-10,r:60,g:60,b:100},{t:-5,r:80,g:80,b:100},{t:0,r:100,g:100,b:100},{t:5,r:50,g:90,b:95},{t:10,r:35,g:85,b:55},{t:15,r:80,g:100,b:35},{t:20,r:90,g:90,b:0},{t:25,r:100,g:75,b:0},{t:30,r:100,g:50,b:0},{t:35,r:100,g:0,b:0},{t:40,r:75,g:0,b:0},{t:45,r:50,g:0,b:0},{t:50,r:25,g:0,b:0}];e=255/100;g=[];for(m=l=0,o=s.length-1;0<=o?l<o:l>o;m=0<=o?++l:--l){a=s[m];h=s[m+1];n=t(a.t);i=t(h.t);for(w=u=n;n<=i?u<i:u>i;w=n<=i?++u:--u){r=1*(w-n)/(i-n);y=1-r;p=t(e*(a.r*y+h.r*r));f=t(e*(a.g*y+h.g*r));c=t(e*(a.b*y+h.b*r));g.push("rgba("+p+","+f+","+c+",0.5)")}}d=s[s.length-1];p=t(e*d.r);f=t(e*d.g);c=t(e*d.b);g.push("rgba("+p+","+f+","+c+",0.5)");return g}();f=o.length-1;y=50;S=function(e){if(e!=null){if((e=t(e+y))<0){e=0}else if(e>f){e=f}return o[e]}else{return"none"}};i=function(){var s,r,o,i,e,a,n;i=["rgba(60,120,255,0)"];for(e=n=1;n<=400;e=++n){a=60-e*.15;o=120-e*.3;r=255-e*.45;s=D(e+1)*.15;i.push("rgba("+t(a)+","+t(o)+","+t(r)+","+s.toFixed(3)+")")}return i}();a=i.length-1;x=function(e){if(e!=null){if((e=t(2*e))>a){e=a}return i[e]}else{return"none"}};v=function(){var t,e,i;t=["rgba(255,120,0,0)"];for(e=i=1;i<=10;e=++i){t.push("rgba(255,120,0,"+(e*.075).toFixed(3)+")")}return t}();L=function(e){return v[t(e*10)]||"none"};s=function(){var t,n,e;t=0;e=[];while(t<i.length){n=i[t];t+=10;e.push(n)}return e}();r=s.length-1;C=function(e){if(e!=null){if((e=t(e))>r){e=r}return s[e]}else{return"none"}};p=i;l=p.length-1;_=function(e){var i;if(e!=null){if((e=t(.5*e))>l){i=l}return p[e]}else{return"none"}};h=function(){var t,e;e=[];for(c=t=0;t<=500;c=++t){e.push("M0,"+(c*.4).toFixed(1)+"L4,0L-4,0Z")}return e}();u=h.length-1;b=function(t){if(t!=null){if((t=t*10>>0)>u){t=u}return h[t]}else{return"M0,0"}};T=e(1e3,.5,4);window.Presentation={generateScale:e,scale:{dot:g,circle:d,wind:w,size:M},fill:{dot:{regular:P,grayed:m}},gradient:{temp:S,prec:x,sun:L,fall:C,depth:_},path:{wind:{fill:"rgba(0,0,150,0.35)",stroke:"rgba(0,0,150,0.25)",strokeWidth:"3",strokeLineCap:"round",strokeLineJoin:"round",render:b}},animation:{interval:T}}}).call(this);(function(){var c,e,w,i,h,n,d,x,r,s,g,a,p,f,u,y,D,l,t,v,m,o,b,T={}.hasOwnProperty,M=function(t,e){for(var i in e){if(T.call(e,i))t[i]=e[i]}function n(){this.constructor=t}n.prototype=e.prototype;t.prototype=new n;t.__super__=e.prototype;return t};o=Math.log;r=1/Math.LN10;b=function(i){var n,s,e,t,a;s=o(i)*r;n=Math.floor(s);e=Math.pow(10,n);t=i/e;return a=e*(t<1.2?.2:t<3?.5:t<5?1:2)};m=function(e){var t;t=o(e)*r;if(t>=0){return 0}else{return Math.ceil(-t)}};a=window.SVGNS;f=Pref.W_GRADATION_DISPLAY;s=10;u=f+2*s;y=80;D=y+2*s;v=7;t=11;d=-2;l=t+3;h=8;n=l+h;x=n;g=/rgba\((\d+,\s*\d+,\s*\d+),\s*(.+)\)/;p=function(){function e(t,e,i,n,s,r){this.width=t;this.height=e;this.margin=i;this.x0=n;this.x1=s;this.dxScale=r;this.svg=this.createElem("svg").attr({version:"1.1",xmlns:a,width:this.width,height:this.height});this.createScale()}e.prototype.createElem=function(t){return $(document.createElementNS(a,t))};e.prototype.getSvg=function(){return this.svg};e.prototype.createScale=function(){this.gScale=this.createElem("g").attr({stroke:"rgba(0, 0, 0, 0.75)","stroke-width":1,"stroke-linecap":"square","shape-rendering":"crispEdges"}).appendTo(this.svg);return this.gText=this.createElem("g").attr({"font-family":"Arial, sans-serif","font-size":"9px","text-anchor":"middle"}).appendTo(this.svg)};e.prototype.drawScale=function(){var s,e,r,i,n;this.createElem("line").attr({x1:this.margin,y1:t,x2:this.width-this.margin,y2:t}).appendTo(this.gScale);i=this.x0;e=this.margin;r=1*(this.width-2*this.margin)/(this.x1-this.x0);s=m(this.dxScale);n=[];while(i<=this.x1){e=this.margin+r*(i-this.x0);this.createElem("line").attr({x1:e,y1:t,x2:e,y2:t+d}).appendTo(this.gScale);this.createElem("text").attr({x:e,y:v}).append(i.toFixed(s)).appendTo(this.gText);n.push(i+=this.dxScale)}return n};return e}();i=function(e){M(t,e);function t(e,i,r,o,a,h){this.dxGrad=o;this.gradId=a;this.gradFunc=h;t.__super__.constructor.call(this,u,n,s,e,i,r);this.createGradient();this.createDisplay();this.drawScale()}t.prototype.parseRGBA=function(e){var t;t=e.match(g);if(t!=null){return["rgb("+t[1]+")",t[2]]}else{return[e,e]}};t.prototype.createGradient=function(){var n,s,r,t,e,i;s=this.createElem("linearGradient").attr({id:this.gradId}).appendTo(this.svg);t=this.x0;i=[];while(t<=this.x1){e=this.parseRGBA(this.gradFunc(t)),r=e[0],n=e[1];this.createElem("stop").attr({offset:""+100*(t-this.x0)/(this.x1-this.x0)+"%","stop-color":r,"stop-opacity":n}).appendTo(s);i.push(t+=this.dxGrad)}return i};t.prototype.createDisplay=function(){return this.createElem("rect").attr({x:this.margin,y:l,width:this.width-2*this.margin,height:h,fill:"url(#"+this.gradId+")"}).appendTo(this.svg)};return t}(p);c=function(){function t(t,e,i){this.parent=t;this.width=e;this.height=i;this.frame=$("<div id='tenkiGradation'/>").css({width:""+this.width+"px",height:""+this.height+"px"}).appendTo(this.parent)}t.prototype.setDisplay=function(t){this.frame.empty();if(t!=null){return this.frame.append(t.getSvg())}};return t}();e=Presentation.gradient;w=function(){function t(t,s){t=$(t);this.row=$("<div />").appendTo(t);this.gradFrame=new c(this.row,u,n);this.temp=new i(-30,40,10,1,"SvgTempGrad",e.temp);this.prec=new i(0,100,20,1,"SvgPrecGrad",e.prec);this.sun=new i(0,1,.2,.1,"SvgPrecSun",e.sun);this.fall=new i(0,20,5,1,"SvgPrecFall",e.fall);this.depth=new i(0,300,50,1,"SvgPrecDepth",e.depth)}t.prototype.setGrad=function(t){return this.gradFrame.setDisplay(function(){switch(t){case"t":return this.temp;case"p":return this.prec;case"s":return this.sun;case"f":return this.fall;case"d":return this.depth;default:return null}}.call(this))};return t}();window.GradationDisplay=w}).call(this);(function(){var t,o,h,e,l,p,f,a,u,s,r,i,c,y,d,n,m;n=Math.ceil;m=Math.floor;i=Date.MIN;o=Date.HOUR;t=Date.DAY;y=Date.WEEK;d=465;e=function(){function t(t,e,n,s,r){this.l=t;this.r=e;this.dss=n;this.ds=s;this.dt=r;this.tz=new Date(+this.l).getTimezoneOffset()*i;this.step=this.dss*o}t.prototype.reset=function(){return this.setT(n((this.l-this.tz)/this.step)*this.step+this.tz)};t.prototype.next=function(){return this.setT(this.t+this.step)};t.prototype.setT=function(i){var e,t;this.t=i;if(this.t>this.r){return this.t=this.s=null}else{e=new Date(+this.t);t=e.hour();this.s=t===0?""+e.mon()+"/"+e.day():t%this.dt===0?""+t+":00":t%this.ds===0?"":null;return this.t}};return t}();h=function(){function t(t,e,n){this.l=t;this.r=e;this.dss=n;this.tz=new Date(+this.l).getTimezoneOffset()*i;this.step=this.dss*o}t.prototype.reset=function(){return this.setT(n((this.l-this.tz)/this.step)*this.step+this.tz)};t.prototype.next=function(){return this.setT(this.t+this.step)};t.prototype.setT=function(i){var t,e;this.t=i;if(this.t>this.r){return this.t=this.s=null}else{t=new Date(+this.t);e=t.hour();this.s=e===0?t.wday()===0?""+t.mon()+"/"+t.day():""+t.day():null;return this.t}};return t}();u=function(){function t(t,e,n){this.l=t;this.r=e;this.dss=n;this.tz=new Date(+this.l).getTimezoneOffset()*i;this.step=this.dss*o}t.prototype.reset=function(){return this.setT(n((this.l-this.tz)/this.step)*this.step+this.tz)};t.prototype.next=function(){return this.setT(this.t+this.step)};t.prototype.setT=function(i){var t,e;this.t=i;if(this.t>this.r){return this.t=this.s=null}else{t=new Date(+this.t);e=t.hour();this.s=e===0?t.wday()===0?""+t.mon()+"/"+t.day():"":null;return this.t}};return t}();a=function(){function e(t,e){this.l=t;this.r=e;this.tz=new Date(+this.l).getTimezoneOffset()*i}e.prototype.reset=function(){return this.setT(n((this.l-this.tz)/t)*t+this.tz)};e.prototype.next=function(){return this.setT(this.t+t)};e.prototype.setT=function(e){var t;this.t=e;if(this.t>this.r){return this.t=this.s=null}else{t=new Date(+this.t);this.s=t.wday()===0?""+t.mon()+"/"+t.day():null;return this.t}};return e}();p=function(){function e(t,e){this.l=t;this.r=e;this.tz=new Date(+this.l).getTimezoneOffset()*i}e.prototype.reset=function(){return this.setT(n((this.l-this.tz)/t)*t+this.tz)};e.prototype.next=function(){return this.setT(this.t+t)};e.prototype.setT=function(e){var t;this.t=e;if(this.t>this.r){return this.t=this.s=null}else{t=new Date(+this.t);this.s=t.day()===1?""+t.mon()+"/"+t.day():t.wday()===0?"":null;return this.t}};return e}();f=function(){function e(t,e){this.l=t;this.r=e;this.tz=new Date(+this.l).getTimezoneOffset()*i}e.prototype.reset=function(){return this.setT(n((this.l-this.tz)/t)*t+this.tz)};e.prototype.next=function(){return this.setT(this.t+t)};e.prototype.setT=function(i){var e;this.t=i;while(this.t<=this.r){e=new Date(+this.t);if(e.day()===1){this.s=e.mon()===1?""+e.year():""+e.mon();return this.t}if(e.wday()===0){this.s=null;return this.t}this.t+=t}return this.t=this.s=null};return e}();l=function(){function t(t,e,i){this.l=t;this.r=e;this.ds=i}t.prototype.reset=function(){var t;t=new Date(+this.l);this.d=Date.YMDH(t.year(),t.mon()+1,1,0);return this.setT(+this.d)};t.prototype.next=function(){return this.setT(+(this.d=this.d.nextMon()))};t.prototype.setT=function(e){var t;this.t=e;if(this.t>this.r){return this.t=this.s=null}else{this.s=(t=this.d.mon())===1?""+this.d.year():t%this.ds===1?""+t:null;return this.t}};return t}();r=function(){function t(t,e,i,n){this.l=t;this.r=e;this.dss=i;this.ds=n}t.prototype.reset=function(){var t;t=new Date(+this.l);this.d=Date.YMDH(t.year(),t.mon()+1,1,0);if(this.dss>1){while(this.d.mon()%this.dss!==1){this.d=this.d.nextMon()}}return this.setT(+this.d)};t.prototype.next=function(){return this.setT(+(this.d=this.d.nextMon(this.dss)))};t.prototype.setT=function(e){var t;this.t=e;if(this.t>this.r){return this.t=this.s=null}else{this.s=(t=this.d.mon())===1?""+this.d.year():t%this.ds===1?"":null;return this.t}};return t}();s=function(){function t(t,e,i,n,s){this.l=t;this.r=e;this.dss=i;this.ds=n;this.dt=s}t.prototype.reset=function(){var t;t=new Date(+this.l);this.d=Date.YMDH(t.year()+1,1,1,0);if(this.dss>1){while(this.d.year()%this.dss!==0){this.d=this.d.nextYear()}}return this.setT(+this.d)};t.prototype.next=function(){return this.setT(+(this.d=this.d.nextYear(this.dss)))};t.prototype.setT=function(e){var t;this.t=e;if(this.t>this.r){return this.t=this.s=null}else{t=this.d.year();this.s=t%this.dt===0?""+this.d.year():t%this.ds===0?"":null;return this.t}};return t}();c=function(i,n,o){o=(n-i)*d/o;if(o<t){return new e(i,n,1,3,3)}else if(o<2*t){return new e(i,n,1,3,6)}else if(o<3*t){return new e(i,n,3,6,12)}else if(o<4*t){return new e(i,n,3,12,12)}else if(o<5*t){return new e(i,n,3,12,24)}else if(o<7*t){return new e(i,n,6,12,24)}else if(o<10*t){return new e(i,n,6,24,24)}else if(o<12*t){return new e(i,n,12,24,24)}else if(o<16*t){return new h(i,n,12)}else if(o<25*t){return new u(i,n,12)}else if(o<72*t){return new a(i,n,24)}else if(o<100*t){return new p(i,n)}else if(o<500*t){return new f(i,n)}else if(o<1200*t){return new l(i,n,3)}else if(o<1800*t){return new r(i,n,1,6)}else if(o<2400*t){return new r(i,n,3,6)}else if(o<3600*t){return new r(i,n,3,12)}else if(o<5e3*t){return new r(i,n,6,12)}else if(o<8e3*t){return new s(i,n,1,2,2)}else if(o<16e3*t){return new s(i,n,1,5,5)}else if(o<32e3*t){return new s(i,n,1,5,10)}else{return new s(i,n,2,10,20)}};window.TimeScaleIterator=c}).call(this);(function(){var t,e,i;i=Math.ceil;t=270;e=function(){function e(i,n,s){var e;this.v0=i;this.v1=n;e=(this.v1-this.v0)*t/s;if(e<2){this.ds=.2;this.dss=.1;this.fs=1}else if(e<4){this.ds=.5;this.dss=.1;this.fs=1}else if(e<8){this.ds=1;this.dss=.2}else if(e<20){this.ds=2;this.dss=.5}else if(e<40){this.ds=5;this.dss=1}else if(e<80){this.ds=10;this.dss=2}else if(e<200){this.ds=20;this.dss=5}else if(e<400){this.ds=50;this.dss=10}else if(e<800){this.ds=100;this.dss=20}else{this.ds=200;this.dss=50}this.di=this.ds/this.dss}e.prototype.reset=function(){return this.set(i(this.v0/this.dss))};e.prototype.next=function(){return this.set(++this.i)};e.prototype.set=function(t){this.i=t;if((this.v=this.i*this.dss)<=this.v1){this.s=this.i%this.di===0?this.fs!=null?this.v.toFixed(this.fs):""+this.v:null;return this.v}else{return this.v=this.s=null}};return e}();window.ValueScaleIterator=e}).call(this);(function(){var G,a,P,E,O,s,d,y,r,R,x,V,M,I,f,i,t,m,g,o,e,Y,p,b,H,C,h,n,L,S,D,A,c,_,N,T,l,u,k,v,w,z={}.hasOwnProperty,F=function(t,e){for(var i in e){if(z.call(e,i))t[i]=e[i]}function n(){this.constructor=t}n.prototype=e.prototype;t.prototype=new n;t.__super__=e.prototype;return t},W=[].slice;T=Math.exp;k=MiscUtils.limitMinMax;w=DataInfo.timeMin;v=DataInfo.timeMax;i=window.SVGNS;O=Date.HOUR;G=Date.DAY;I=Places;g=Pref.W_GRAPH_VIEW;y=Pref.H_GRAPH_VIEW;x=36;M=26;V=18;R=24;e=x;n=M;t=g-x-V;s=y-M-R;o=e+t;h=n+s;p=e-4;S=n+s+7;C=p;c=12;Y=e+t;L=c;m=220;d=50;f=4;b=e+t/2;D=n+s/2;H=b-m/2;A=D-d/2;_=.012;N=.1;P=["t","p","w","s","f","d"];a={t:{flag:4,name:"気温",unit:"(℃)",path:"graphPathT",offset:[1,2],defMax:30,margin:4},p:{flag:1,name:"降水量",unit:"(mm)",path:"graphPathP",offset:0,defMax:10},w:{flag:2,name:"風速",unit:"(m/s)",path:"graphPathW",offset:3,defMax:10},s:{flag:8,name:"日照時間",unit:"(時)",path:"graphPathS",offset:5,defMax:1.1},f:{flag:16,name:"降雪量",unit:"(cm)",path:"graphPathF",offset:6,defMax:10},d:{flag:16,name:"積雪量",unit:"(cm)",path:"graphPathD",offset:7,defMax:40}};u=function(){return O*12};l=function(){return(v()-w())*1.2};r=MiscUtils.LinMap;E=function(M){F(x,M);function x(S){var _,w,l,u,T,r,p,o,v,M;this.infoView=S;x.__super__.constructor.call(this,"div");this.weatherCtl=this.infoView.weatherCtl;this.trendCtl=new TrendController(this);this.type="t";this.appendChild(this.svg=o=document.createElementNS(i,"svg"));o.setAttribute("class","graph");o.setAttribute("version","1.1");o.setAttribute("xmlns",i);o.setAttribute("width",""+g);o.setAttribute("height",""+y);o.appendChild(this.unit=v=document.createElementNS(i,"text"));v.setAttribute("class","graphLabelL");v.setAttribute("x",""+C);v.setAttribute("y",""+c);v.appendChild(document.createTextNode(a[this.type].name));o.appendChild(w=document.createElementNS(i,"text"));w.setAttribute("class","graphLabelL");w.setAttribute("x",""+Y);w.setAttribute("y",""+L);w.appendChild(document.createTextNode("横ドラッグ: 時間移動       縦ドラッグ/ホイール: ズーム  "));o.appendChild(this.rect=p=document.createElementNS(i,"rect"));p.setAttribute("class","graphBG");p.setAttribute("x",""+e);p.setAttribute("y",""+n);p.setAttribute("width",""+t);p.setAttribute("height",""+s);o.appendChild(this.gp=document.createElementNS(i,"g"));o.appendChild(this.gs=document.createElementNS(i,"g"));o.appendChild(this.marker=l=document.createElementNS(i,"line"));M=""+(e+t/2);l.setAttribute("class","graphMarker");l.setAttribute("x1",M);l.setAttribute("x2",M);l.setAttribute("y1",""+n);l.setAttribute("y2",""+h);o.appendChild(r=document.createElementNS(i,"rect"));r.setAttribute("class","graphMousePane");r.setAttribute("x",""+e);r.setAttribute("y",""+n);r.setAttribute("width",""+t);r.setAttribute("height",""+s);r=jQuery(r);r.mousedown(function(t){return function(e){return t.mousedown(e)}}(this));r.mousemove(function(t){return function(e){return t.mousemove(e)}}(this));r.mouseup(function(t){return function(e){return t.mouseup(e)}}(this));r.mouseout(function(t){return function(e){return t.mouseup(e)}}(this));r.mousewheel(function(t){return function(e){return t.mousewheel(e)}}(this));this.gm=_=document.createElementNS(i,"g");_.appendChild(u=document.createElementNS(i,"rect"));u.setAttribute("class","graphMsgBox");u.setAttribute("x",""+H);u.setAttribute("y",""+A);u.setAttribute("width",""+m);u.setAttribute("height",""+d);u.setAttribute("rx",""+f);u.setAttribute("ry",""+f);_.appendChild(this.msgText=T=document.createElementNS(i,"text"));T.setAttribute("class","graphMsgText");T.setAttribute("x",""+b);T.setAttribute("y",""+D);return}x.prototype.initTimeView=function(){var t;if(this.tL==null){if((t=this.weatherCtl.getTime())!=null){t=+t.floorDay();this.tL=t;this.tR=t+Date.DAY}}return this.tL};x.prototype.onSetPlace=function(){if(this.initTimeView()!=null){this.trendCtl.requestData(this.infoView.id,this.tL,this.tR,t)}};x.prototype.onAttach=function(i){var e,t;if((this.attached=i?true:null)!=null){if(this.tL!=null&&this.tR!=null){t=+this.weatherCtl.getTime();if(!(this.tL<=t&&t<=this.tR)){e=(this.tR-this.tL)/2;this.tL=t-e;this.tR=t+e}}this.onSetPlace()}};x.prototype.update=function(s,r){var n,i,e;if(r){if(s===this.trendCtl){i=this.trendCtl.iterator;this.tL=+i.tL;this.tR=+i.tR;this.renderGraph(i)}else{this.initTimeView();e=+this.weatherCtl.getTime();if(this.tL<=e&&e<=this.tR){this.updateMarker()}else{n=(this.tR-this.tL)/2;this.trendCtl.requestData(this.infoView.id,e-n,e+n,t)}}}};x.prototype.renderGraph=function(t){this.removeChildren(this.gp,this.gs);this.renderHScale(t);if(this.type==="t"){this.renderTemp(t)}else{this.renderValue(this.type,t)}this.updateMarker();this.updateMessage(t)};x.prototype.renderTemp=function(s){var m,M,x,_,v,w,g,d,D,f,i,c,p,l,t,b,T,u,y;p=a.t;v=p.path;if((D=this.findTMinMax(s))!=null){this.showMessage(null);d=D[0]-p.margin;g=D[1]+p.margin;this.renderVScale(d,g);T=new r(s.tL,s.tR,e,o);m=T.a;M=T.b;y=new r(d,g,h,n);f=y.a;c=y.b;l=s.reset();_=s.dt;i=null;while(l!=null){if((x=s.x)!=null&&(w=x[1])!=null){t=(t=m*l+M)>o?""+o:(""+t).slice(0,6);u=(""+(f*x[2]+c)).slice(0,6);i=i!=null?"H"+t+"V"+(""+(f*w+c)).slice(0,6)+i+("V"+u+"H"+t):((b=m*(l-_)+M)<e?b=e:void 0,"H"+t+"V"+(""+(f*w+c)).slice(0,6)+("H"+b+"V"+u+"H"+t))}else if(i!=null){this.addPath("M"+t+","+u+i+"Z",v);i=null}l=s.next()}if(i!=null){this.addPath("M"+t+","+u+i+"Z",v)}}else{this.renderVScale(0,p.defMax)}};x.prototype.renderValue=function(S,u){var y,w,L,M,g,m,p,d,C,i,_,f,l,T,v,D,x,c,b;f=a[S];g=f.offset;d=f.defMax;m=f.path;if((p=this.findMax(u,g))!=null){if((p*=1.05)<d){p=d}this.renderVScale(0,p);x=new r(u.tL,u.tR,e,e+t);y=x.a;w=x.b;b=new r(0,p,n+s,n);C=b.a;_=b.b;l=u.reset();M=u.dt;c=""+h;i=null;while(l!=null){if((L=u.x)!=null&&(T=L[g])!=null){if(i==null){if((D=y*(l-M)+w)<e){D=e}i="M"+(""+D).slice(0,6)+(","+c)}if((v=y*l+w)>o){v=o}i+="V"+(""+(C*T+_)).slice(0,6)+"H"+(""+v).slice(0,6)}else if(i!=null){this.addPath(""+i+"V"+c+"Z",m);i=null}l=u.next()}if(i!=null){this.addPath(""+i+"V"+c+"Z",m)}}else{this.renderVScale(0,d)}};x.prototype.renderHScale=function(p){var f,m,a,c,o,s,u,d,y,l,g,w,v;d=+p.tL;y=+p.tR;s=TimeScaleIterator(p.tL,p.tR,t);u=s.reset();c=new r(d,y,e,e+t);f=c.a;m=c.b;g=""+n;w=""+h;v=""+S;while(u!=null){this.gs.appendChild(o=document.createElementNS(i,"line"));o.setAttribute("class",s.s!=null?"graphScale":"graphSubscale");l=(""+(f*u+m)).slice(0,6);o.setAttribute("x1",l);o.setAttribute("x2",l);o.setAttribute("y1",g);o.setAttribute("y2",w);if(s.s!=null&&s.s.length>0){this.gs.appendChild(a=document.createElementNS(i,"text"));a.setAttribute("class","graphLabelB");a.setAttribute("x",l);a.setAttribute("y",v);a.appendChild(document.createTextNode(s.s))}u=s.next()}};x.prototype.renderVScale=function(v,f){var y,d,h,c,t,a,l,m,g,w,u;m=""+e;w=""+p;g=""+o;c=new r(v,f,n+s,n);y=c.a;d=c.b;a=new ValueScaleIterator(v,f,s);l=a.reset();while(l!=null){this.gs.appendChild(t=document.createElementNS(i,"line"));t.setAttribute("class",a.s!=null?"graphScale":"graphSubscale");u=(""+(y*l+d)).slice(0,6);t.setAttribute("x1",m);t.setAttribute("x2",g);t.setAttribute("y1",u);t.setAttribute("y2",u);if(a.s!=null){this.gs.appendChild(h=document.createElementNS(i,"text"));h.setAttribute("class","graphLabelL");h.setAttribute("x",w);h.setAttribute("y",u);h.appendChild(document.createTextNode(a.s))}l=a.next()}};x.prototype.updateMarker=function(){var i,n,s;n=+this.weatherCtl.getTime();i=this.marker;if(this.tL<=n&&n<=this.tR){s=(""+(e+t*(n-this.tL)/(this.tR-this.tL))).slice(0,6);i.setAttribute("x1",s);i.setAttribute("x2",s);i.setAttribute("class","graphMarker")}else{i.setAttribute("class","graphHidden")}};x.prototype.updateMessage=function(i){var e,t;e=I[i.id];t=a[this.type];if((e.flags&t.flag)!==0){this.showMessage(null)}else{this.showMessage(t.name+"のデータはありません")}};x.prototype.setTimeView=function(e,i){var n,r,s;if(e<i){s=k(i-e,u(),l());r=s/2;if(e<(n=+w()-r)){e=n;i=e+s}else if(i>(n=+v()+r)){i=n;e=i-s}if(this.attached!=null){this.trendCtl.requestData(this.infoView.id,e,i,t)}}};x.prototype.mousedown=function(e){var i;e.preventDefault();if(this.tL!=null&&this.tR!=null){this.shift=e.shiftKey;this.ctrl=e.ctrlKey;i=this.rect.getBoundingClientRect();this.x=e.clientX-i.left;this.y=e.clientY-i.top;this.w=this.tR-this.tL;this.t=typeof shift!=="undefined"&&shift!==null?this.t=this.tL+this.x*this.w/t:this.t=this.tL+this.x*this.w/t;if(!(this.shift||this.ctrl)){this.weatherCtl.setTime(this.t)}}};x.prototype.mousemove=function(i){var n,r,o,e,s,a;i.preventDefault();if(this.x!=null){n=this.rect.getBoundingClientRect();s=this.ctrl?this.x:i.clientX-n.left;a=i.clientY-n.top;e=this.shift?this.w:this.w*T(_*(a-this.y));if(e<(o=u())){e=o}else if(e>(r=l())){e=r}this.setTimeView(this.t-e*s/t,this.t+e*(t-s)/t)}};x.prototype.mouseup=function(t){this.x=this.y=this.w=this.t=null};x.prototype.mousewheel=function(s){var i,n,r,e,o,a,h;s.preventDefault();if(this.tL!=null&&this.tR!=null){h=s.clientX-this.rect.getBoundingClientRect().left;e=this.tL+(this.tR-this.tL)*h/t;r=T(-N*s.deltaY);i=e-(e-this.tL)*r;n=e+(this.tR-e)*r;if(n-i<(a=u())){i=e-a*(e-this.tL)/(this.tR-this.tL);n=i+a}else if(n-i>(o=l())){i=e-o*(e-this.tL)/(this.tR-this.tL);n=i+o}this.setTimeView(i,n)}};x.prototype.findMax=function(e,r){var t,s,n,i;s=e.reset();t=null;while(s!=null){if((n=e.x)!=null&&(i=n[r])!=null){t=i;break}s=e.next()}if(t!=null){while(e.next()!=null){if((n=e.x)!=null&&(i=n[r])!=null&&i>t){t=i}}}return t};x.prototype.findTMinMax=function(n){var s,e,r,i,t;r=n.reset();e=s=null;while(r!=null){if((i=n.x)!=null&&(t=i[1])!=null){e=t;s=i[2];break}r=n.next()}if(e!=null){while(n.next()!=null){if((i=n.x)!=null&&(t=i[1])!=null){if(t<e){e=t}if((t=i[2])>s){s=t}}}return[e,s]}};x.prototype.addPath=function(e,n){var t;this.gp.appendChild(t=document.createElementNS(i,"path"));t.setAttribute("class",n);t.setAttribute("d",e)};x.prototype.setGraph=function(t){if(P.indexOf(t)!==-1){this.type=t;this.removeChildren(this.unit);this.unit.appendChild(document.createTextNode(a[this.type].unit));if(this.trendCtl.iterator!=null){this.update(this.trendCtl,true)}}};x.prototype.showMessage=function(t){if(t!=null){if(this.gm.parentNode==null){this.svg.appendChild(this.gm)}this.removeChildren(this.msgText);this.msgText.appendChild(document.createTextNode(t))}else{if(this.gm.parentNode!=null){this.svg.removeChild(this.gm)}}};x.prototype.removeChildren=function(){var i,e,t,n;e=1<=arguments.length?W.call(arguments,0):[];for(t=0,n=e.length;t<n;t++){i=e[t];MiscUtils.removeChildren(i)}};return x}(GoogleMapsWidget.Element);window.GraphView=E}).call(this);(function(){var n,s,i,r,t,e,a={}.hasOwnProperty,o=function(t,e){for(var i in e){if(a.call(e,i))t[i]=e[i]}function n(){this.constructor=t}n.prototype=e.prototype;t.prototype=new n;t.__super__=e.prototype;return t};r=Date.HOUR;i=["時刻<br />(時)","気温<br />(℃)","降水量<br />(mm)","風速<br />(m/s)","風向","日照時間<br />(時)","降雪量<br />(cm)","積雪量<br />(cm)"];n=DataInfo.WIND_DIRECTION;t="---";e=function(i){o(e,i);function e(i,n,s,r){this.view=s;this.hour=r;e.__super__.constructor.call(this,i,t,n);this.bind("mousedown",function(t){return function(e){return t.mousedown(e)}}(this))}e.prototype.mousedown=function(t){return this.view.clickOnTable(this.hour)};return e}(GoogleMapsWidget.TD);s=function(a){o(s,a);function s(h){var o,n,t,r,a;this.infoView=h;s.__super__.constructor.call(this,null);this.weatherCtl=this.infoView.weatherCtl;this.trendCtl=new TrendController(this);t=this.addTR();for(r=0,a=i.length;r<a;r++){o=i[r];t.addTH(o)}this.items=function(){var i,s;s=[];for(n=i=0;i<24;n=++i){t=this.addTR();s.push([new e(t,"right",this,n),new e(t,"right",this,n),new e(t,"right",this,n),new e(t,"right",this,n),new e(t,"center",this,n),new e(t,"right",this,n),new e(t,"right",this,n),new e(t,"right",this,n)])}return s}.call(this);this.id=this.t0=this.now=null}s.prototype.onSetPlace=function(){var t;if((t=this.weatherCtl.getTime())!=null){t=t.floorDay();this.trendCtl.requestData(this.infoView.id,t,t.nextHour(23),24)}};s.prototype.onAttach=function(t){if(t){this.onSetPlace()}};s.prototype.update=function(e,i){var t;if(i){if(e===this.weatherCtl){this.updateTime(this.weatherCtl.getTime())}else{if((t=e.iterator)!=null&&t.hasData!=null){this.updateTable(t)}else{this.clearTable()}}}};s.prototype.updateTime=function(t){t=t.floorDay();if(this.t0!=null&&this.t0.sameDay(t)&&this.id!=null&&this.id===this.infoView.id){this.updateNow()}else{this.trendCtl.requestData(this.infoView.id,t,t.nextHour(23),24)}};s.prototype.updateTable=function(a){var y,D,w,s,h,m,g,o,u,e,d,T,i,l,p,c,f,C,_,M,b,x,v;o=a.reset();u=new Date(o).floorHour();if(this.id!==a.id||this.t0==null||!this.t0.sameDay(u)){this.id=a.id;this.t0=u;h=function(){v=[];for(l=0;l<=23;l++){v.push(l)}return v}.apply(this);while(o!=null){i=a.x;s=(o-u)/r;if((e=this.items[s])!=null){if(i!=null){h.splice(h.indexOf(s),1);m=i[0];d=i[1];T=i[3];D=i[4];g=i[5];w=i[6];y=i[7];e[0].setText(""+s);e[1].setText(d!=null?d.toFixed(1):t);e[2].setText(m!=null?m.toFixed(1):t);e[3].setText(T!=null?T.toFixed(1):t);e[4].setText(D!=null?n[D]:t);e[5].setText(g!=null?g.toFixed(1):t);e[6].setText(w!=null?""+w:t);e[7].setText(y!=null?""+y:t)}else{b=this.items[s];for(p=0,C=b.length;p<C;p++){e=b[p];e.setText(t)}}}o=a.next()}for(c=0,_=h.length;c<_;c++){s=h[c];x=this.items[s];for(f=0,M=x.length;f<M;f++){e=x[f];e.setText(t)}}}this.updateNow()};s.prototype.updateNow=function(){var t;if(this.now!=null){this.setHighlight(this.now.hour(),false)}this.now=null;t=this.weatherCtl.getTime();if(this.t0!=null&&this.t0.sameDay(t)){this.setHighlight(t.hour(),true);this.now=t}};s.prototype.setHighlight=function(r,e){var n,t,s,i;e=e?"highlight":"regular";i=this.items[r];for(t=0,s=i.length;t<s;t++){n=i[t];n.setHighlight(e)}};s.prototype.clearTable=function(){var r,n,e,i,o,a,s;s=this.items;for(e=0,o=s.length;e<o;e++){n=s[e];for(i=0,a=n.length;i<a;i++){r=n[i];r.setText(t)}}};s.prototype.clickOnTable=function(e){var t;if(!this.t0){return}t=this.t0.nextHour(e);if(DataInfo.timeMin()<=t&&t<=DataInfo.timeMax()){this.weatherCtl.setTime(t)}};return s}(GoogleMapsWidget.Table);window.DataView=s}).call(this);(function(){var e,i,t,n,s,r,o={}.hasOwnProperty,a=function(t,e){for(var i in e){if(o.call(e,i))t[i]=e[i]}function n(){this.constructor=t}n.prototype=e.prototype;t.prototype=new n;t.__super__=e.prototype;return t};n=Places;t="---";r=/^(.+) - (.+)$/;e=["北緯","南緯"];i=["東経","西経"];s=function(o){a(s,o);function s(i){var e;this.infoView=i;s.__super__.constructor.call(this,null);e=this.addTR();e.addTH("地域");this.pref=e.addTDL(t);e=this.addTR();e.addTH("地名");this.name=e.addTDL(t);e=this.addTR();e.addTH("緯度");this.lat=e.addTDL(t);e=this.addTR();e.addTH("経度");this.lon=e.addTDL(t);e=this.addTR();e.addTH("標高");this.alt=e.addTDL(t);e=this.addTR();e.addTH("観測量");this.obs=e.addTDL(t)}s.prototype.refresh=function(){var h,s,u,o,a;h=this.infoView.id;if((s=n[h])!=null){u=s.name.match(r);this.pref.setText(u[1]);this.name.setText(u[2]);o=this.numberToDegMinSec(s.lat);a=this.numberToDegMinSec(s.lon);this.lat.setText(""+e[o[0]]+o[1]+"度"+o[2]+"分"+o[3]+"秒");this.lon.setText(""+i[a[0]]+a[1]+"度"+a[2]+"分"+a[3]+"秒");this.alt.setText(""+s.alt.toFixed(h>=1e4?1:0)+"m");this.obs.setText(this.observingValues(s.flags))}else{this.pref.setText(t);this.name.setText(t);this.lat.setText(t);this.lon.setText(t);this.alt.setText(t);this.obs.setText(t)}};s.prototype.numberToDegMinSec=function(e){var t;t=Math.round(3600*Math.abs(e));return[Number(e<0),t/3600>>0,(t/60>>0)%60,t%60]};s.prototype.observingValues=function(e){var t;t=[];if((e&4)!==0){t.push("気温")}if((e&1)!==0){t.push("降水量")}if((e&2)!==0){t.push("風速・風向")}if((e&8)!==0){t.push("日照時間")}if((e&16)!==0){t.push("降雪・積雪")}return t.join(", ")};s.prototype.onAttach=function(t){if(t){return this.refresh()}};s.prototype.update=function(e,t){if(t){return this.refresh()}};s.prototype.onSetPlace=function(){return this.refresh()};return s}(GoogleMapsWidget.Table);window.PlaceInfoView=s}).call(this);(function(){var i,t,n,s,r,o,e,a;t=Places;a=["日","月","火","水","木","金","土"];e=["t","p","w","s","f","d","l","i"];o=/^([01])$/;s=/^(\d+)$/;n=/^([tpwsfdli])$/;r=/^(\d{4})(\d\d)(\d\d)(\d\d)(\d\d),(\d{4})(\d\d)(\d\d)(\d\d)(\d\d)$/;i=function(){function i(n,s){var i,t;this.frame=n;this.weatherView=s;this.weatherCtl=this.weatherView.ctl;this.weatherCtl.addView(this);this.view=this.frame.addSubframe();this.frame.removeChild(this.view);this.attached=false;this.view.addHR();t=this.view.addRow();t.getElement().style.height="18px";this.name=t.addStatic("---");i=document.createElement("div");i.className="topRight";t.appendChild(i);new GoogleMapsWidget.Button(i,"&nbsp;閉じる&nbsp;","情報ビューを閉じる",function(t){return function(){return t.attach(false)}}(this));t=this.view.addRow();this.radT=t.addRadioGroup(function(t){return function(i){return t.setViewType(e[i])}}(this));this.radT.add("気温","気温トレンドグラフを表示");this.radT.add("降水","降水量トレンドグラフを表示");this.radT.add("風速","風速トレンドグラフを表示");this.radT.add("日照","日照時間トレンドグラフを表示");this.radT.add("降雪","降雪量トレンドグラフを表示");this.radT.add("積雪","積雪量トレンドグラフを表示");this.radT.add("データ","一日分の全データを表示");this.radT.add("地点情報","地点情報を表示");this.radT.finalize(0);this.contentsFrame=this.view.addRow();
this.contents=this.graph=new GraphView(this);this.data=new DataView(this);this.placeInfo=new PlaceInfoView(this);this.type="t";this.contentsFrame.appendChild(this.graph);this.graph.onAttach(true)}i.prototype.processOption=function(i){var a,p,h,u,e,l;a=l=h=u=null;if(i.v!=null&&(e=i.v.match(o))){a=e[1]==="1"}if(i.p!=null&&(e=i.p.match(s))){if(t[p=parseInt(e[1])]!=null){this.id=p}}if(i.i!=null&&(e=i.i.match(n))){l=e[1]}if(i.r!=null&&(e=i.r.match(r))){h=Date.YMDHM(parseInt(e[1]),parseInt(e[2]),parseInt(e[3]),parseInt(e[4]),parseInt(e[5]));u=Date.YMDHM(parseInt(e[6]),parseInt(e[7]),parseInt(e[8]),parseInt(e[9]),parseInt(e[10]))}if(a!=null){this.attach(a)}if(this.id!=null&&this.attached){this.weatherView.showMarker(this.id);this.showPlace(this.id)}if(h!=null&&u!=null){this.graph.setTimeView(h,u)}if(l!=null){this.setViewType(l)}};i.prototype.attach=function(t){if(t){if(!this.attached){this.frame.appendChild(this.view)}}else{if(this.attached){this.frame.removeChild(this.view)}this.weatherView.showMarker(null)}return this.attached=t};i.prototype.showPlace=function(t){this.id=t;this.attach(true);this.updateTitle();return this.contents.onSetPlace()};i.prototype.update=function(e,t){if(!(this.attached&&t)){return}this.updateTitle();return this.contents.update(e,t)};i.prototype.setViewType=function(i){var t;this.type=i;this.radT.select(e.indexOf(this.type));t=function(){switch(this.type){case"l":return this.data;case"i":return this.placeInfo;default:this.graph.setGraph(this.type);return this.graph}}.call(this);if(this.contents===t){return}this.contents.onAttach(false);this.contentsFrame.replaceChild(t,this.contents);this.contents=t;this.contents.onAttach(true)};i.prototype.updateTitle=function(){var n,e,i;i=(e=this.weatherCtl.getTime())!=null?""+e.year()+"年"+e.mon()+"月"+e.day()+"日 ("+a[e.wday()]+") "+e.hour()+"時":"----年--月--日 --時";i+=" &nbsp; ";n=t[this.id];i+=n!=null?n.name:"---";this.name.setText(i)};i.prototype.sNN=function(t){if(t<10){return"0"+t}else{return""+t}};i.prototype.getTimeQuery=function(t){t=new Date(t);return""+t.year()+this.sNN(t.mon())+this.sNN(t.day())+this.sNN(t.hour())+this.sNN(t.min())};i.prototype.getQuery=function(){var e,t,i;t="v="+(this.attached?"1":"0");if(this.id!=null){t+="&p="+this.id}if(this.type!=null){t+="&i="+this.type}e=this.graph.tL;i=this.graph.tR;if(e!=null&&i!=null){t+="&r="+this.getTimeQuery(e)+","+this.getTimeQuery(i)}return t};return i}();window.InfoView=i}).call(this);(function(){var e,n,o,t,h,r,p,u,l,i,a,s;u=/^(\d{4})(\d\d)(\d\d)(\d\d)(\d\d)$/;o=["t","p","s","f","d"];p=[["遅い",0],["通常",1],["速い",2],["最速",3]];h=[["気温","t"],["降水","p"],["日照","s"],["降雪","f"],["積雪","d"]];r=[["なし",0],["小",1],["中",2],["大",3]];a=navigator.userAgent.indexOf("Chrome")!==-1;e=a?"◀":"◂";n=a?"▶":"▸";t=Pref.platform==="pc";i=function(r,n){var e,t,s,i;i=[];for(t=0,s=n.length;t<s;t++){e=n[t];i.push(r.add(e[0],e[1]))}return i};s=function(o,a,h){var e,t,s,i,r,n;i=o.options();n=[];for(t=0,s=i.length;t<s;t++){e=i[t];n.push(e.disabled=!(a<=(r=parseInt(e.value))&&r<=h))}return n};l=function(){function a(i){var t,e;this.weatherView=i;this.ctl=this.weatherView.ctl;this.frame=new GoogleMapsWidget.Frame;this.createDateTimeControls();this.createOptionControls();this.createDisplay();this.infoView=new InfoView(this.frame,this.weatherView);t=this.frame.getElement();t.index=1;e=this.weatherView.getMap().controls;e[google.maps.ControlPosition.TOP_CENTER].push(t)}a.prototype.createDateTimeControls=function(){var s,r,o,i,a,h,u;i=this.frame.addRow();if(t){this.prevY=i.addButton(e,"1年前",function(t){return function(){return t.buttonPrevY()}}(this))}this.selY=i.addSelect(function(t){return function(){return t.selectDate()}}(this));this.selY.setTitle("年の設定");this.updateSelY();if(t){this.nextY=i.addButton(n,"1年後",function(t){return function(){return t.buttonNextY()}}(this))}i.addText("年");i.addSpacer(2);if(t){this.prevM=i.addButton(e,"1ヶ月前",function(t){return function(){return t.buttonPrevM()}}(this))}this.selM=i.addSelect(function(t){return function(){return t.selectDate()}}(this));this.selM.setTitle("月の設定");for(o=a=1;a<=12;o=++a){this.selM.add(""+o,""+o)}if(t){this.nextM=i.addButton(n,"1ヶ月後",function(t){return function(){return t.buttonNextM()}}(this))}i.addText("月");i.addSpacer(2);this.prevD=i.addButton(e,"1日前",function(t){return function(){return t.buttonPrevD()}}(this));this.selD=i.addSelect(function(t){return function(){return t.selectDate()}}(this));this.selD.setTitle("日の設定");for(s=h=1;h<=31;s=++h){this.selD.add(""+s,""+s)}this.nextD=i.addButton(n,"1日後",function(t){return function(){return t.buttonNextD()}}(this));i.addText("日");i.addSpacer(2);this.prevH=i.addButton(e,"1時間前",function(t){return function(){return t.buttonPrevH()}}(this));this.selH=i.addSelect(function(t){return function(){return t.selectDate()}}(this));this.selH.setTitle("時の設定");for(r=u=0;u<=23;r=++u){this.selH.add(""+r,""+r)}this.nextH=i.addButton(n,"1時間後",function(t){return function(){return t.buttonNextH()}}(this));return i.addText("時")};a.prototype.createOptionControls=function(){var e;e=this.frame.addRow();this.play=e.addButton("&nbsp;再生&nbsp;","再生/停止",function(t){return function(){return t.buttonPlay()}}(this));this.selA=e.addSelect(function(t){return function(){return t.selectA()}}(this));this.selA.setTitle("再生速度");i(this.selA,p);e.addSpacer(2);if(t){this.radC=e.addRadioGroup(function(t){return function(e){return t.radioC(e)}}(this));this.radC.add("気温","気温を表示");this.radC.add("降水","降水量を表示");this.radC.add("日照","日照時間を表示");this.radC.add("降雪","降雪量を表示");this.radC.add("積雪","積雪量を表示");this.radC.finalize()}else{this.selC=e.addSelect(function(t){return function(){return t.selectC()}}(this));this.selC.setTitle("円の表示タイプ");i(this.selC,h)}e.addSpacer(1);this.selS=e.addSelect(function(t){return function(){return t.selectS()}}(this));this.selS.setTitle("円のサイズ");i(this.selS,r);e.addSpacer(2);e.addText("風速");e.addSpacer(1);this.selW=e.addSelect(function(t){return function(){return t.selectW()}}(this));this.selW.setTitle("風速・風向の表示サイズ");i(this.selW,r);e.addSpacer(2);return e.addButton("&nbsp;保存&nbsp;","状態をブラウザ履歴に保存",function(t){return function(){return t.saveURL()}}(this))};a.prototype.createDisplay=function(){var i,n,e;n=this.frame.addRow();e=n.getElement();e.css;$(e).css({width:"100%",height:"25px"});i=t?"<a href='index_m.html'class='noDeco'>モバイル版</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;":"<a href='index_p.html'class='noDeco'>PC版&nbsp;&nbsp;&nbsp;&nbsp;</a>";this.disp=new GradationDisplay(e,this.weatherView);return $(e).append($("<div id='tenkiLinks'><br />"+i+"<a href='https://github.com/higuma/tenki-data-map' class='noDeco'>天気データマップについて...</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>"))};a.prototype.parseOption=function(s,a){var t,e,i,r,n,o;this.option=a;for(e in s){n=s[e];switch(e){case"c":switch(n){case"t":case"p":case"s":case"f":case"d":this.option[e]=n}break;case"s":case"w":case"a":if(0<=(o=r=parseInt(n))&&o<=3){this.option[e]=r}break;case"d":if((i=n.match(u))!=null){t=Date.YMDHM(parseInt(i[1]),parseInt(i[2]),parseInt(i[3]),parseInt(i[4]),parseInt(i[5]));t=t.ceilHour();if(DataInfo.timeMin()<=t&&t<=DataInfo.timeMax()){this.option.d=t}}break;default:this.option[e]=n}}};a.prototype.processOption=function(e,i){this.option=i;this.parseOption(e,this.option);this.selA.select(this.option.a);if(t){this.radC.select(o.indexOf(this.option.c))}else{this.selC.select(this.option.c)}this.selS.select(this.option.s);this.selW.select(this.option.w);this.disp.setGrad(this.option.c);this.infoView.processOption(this.option)};a.prototype.sNN=function(t){if(t<10){return"0"+t}else{return""+t}};a.prototype.dateQueryString=function(){var t;t=this.ctl.getTime();return""+t.year()+this.sNN(t.mon())+this.sNN(t.day())+this.sNN(t.hour())+this.sNN(t.min())};a.prototype.updateSelY=function(){var e,s,r,o,t,i,n;i=DataInfo.timeMin().year();t=DataInfo.timeMax().year();e=this.selY.options();if(e.length>0){r=parseInt(e[0].value);o=parseInt(e[e.length-1].value);if(r===i&&o===t){return}}this.selY.clear();for(s=n=i;i<=t?n<=t:n>=t;s=i<=t?++n:--n){this.selY.add(""+s,""+s)}};a.prototype.updateDate=function(){var e,u,c,a,h,o,r,l,p,n,i;this.updateSelY();e=this.ctl.getTime();document.title="天気データマップ "+(""+e.year()+"年"+e.mon()+"月"+e.day()+"日"+e.hour()+"時");i=DataInfo.timeMin();n=DataInfo.timeMax();l=e.sameYear(i)?i.mon():1;p=e.sameYear(n)?n.mon():12;s(this.selM,l,p);u=e.sameMon(i)?i.day():1;c=e.sameMon(n)?n.day():e.daysOfMon();s(this.selD,u,c);a=e.sameDay(i)?1:0;h=e.sameDay(n)?0:23;s(this.selH,a,h);this.selY.select(e.year());this.selM.select(e.mon());this.selD.select(e.day());this.selH.select(e.hour());r=!e.sameHour(i);o=!e.sameHour(n);if(t){this.prevY.enable(r);this.nextY.enable(o);this.prevM.enable(r);this.nextM.enable(o)}this.prevD.enable(r);this.nextD.enable(o);this.prevH.enable(r);return this.nextH.enable(o)};a.prototype.update=function(t){if(!(t&&this.ctl.getData()!=null)){return}this.updateDate();if(this.ctl.isLastFrame()){return this.updatePlayButton("last")}else{return this.updatePlayButton(this.ctl.interval!=null?"stop":"play")}};a.prototype.onUpdateData=function(){return this.update(true)};a.prototype.selectDate=function(){return this.ctl.setTime(Date.YMDH(parseInt(this.selY.value()),parseInt(this.selM.value()),parseInt(this.selD.value()),parseInt(this.selH.value())))};a.prototype.buttonPrevY=function(){return this.ctl.setTime(this.ctl.getTime().prevYear())};a.prototype.buttonNextY=function(){return this.ctl.setTime(this.ctl.getTime().nextYear())};a.prototype.buttonPrevM=function(){return this.ctl.setTime(this.ctl.getTime().prevMon())};a.prototype.buttonNextM=function(){return this.ctl.setTime(this.ctl.getTime().nextMon())};a.prototype.buttonPrevD=function(){return this.ctl.setTime(this.ctl.getTime().prevDay())};a.prototype.buttonNextD=function(){return this.ctl.setTime(this.ctl.getTime().nextDay())};a.prototype.buttonPrevH=function(){return this.ctl.setTime(this.ctl.getTime().prevHour())};a.prototype.buttonNextH=function(){return this.ctl.setTime(this.ctl.getTime().nextHour())};a.prototype.buttonPlay=function(){if(this.ctl.interval!=null){this.weatherView.stop();return this.updatePlayButton("play")}else{this.weatherView.play();return this.updatePlayButton("stop")}};a.prototype.selectA=function(){return this.weatherView.setOption("a",parseInt(this.selA.value()))};a.prototype.radioC=function(e){var t;t=o[e];this.weatherView.setOption("c",t);return this.disp.setGrad(t)};a.prototype.selectC=function(){var t;t=this.selC.value();this.weatherView.setOption("c",t);return this.disp.setGrad(t)};a.prototype.selectS=function(){var t;t=parseInt(this.selS.value());this.weatherView.setOption("s",t);this.radC.enable(t!==0);return this.disp.setGrad(t!==0?this.option.c:null)};a.prototype.selectW=function(){var t;t=parseInt(this.selW.value());return this.weatherView.setOption("w",t)};a.prototype.updatePlayButton=function(t){switch(t){case"play":case"last":return this.play.enable(t==="play").setText("&nbsp;再生&nbsp;").setHighlight("regular");case"stop":return this.play.enable(true).setText("&nbsp;停止&nbsp;").setHighlight("highlight")}};a.prototype.saveURL=function(){var e,t;t=this.weatherView.getMap();e=t.getCenter();return window.location.hash="#"+("ll="+e.lat().toFixed(5)+","+e.lng().toFixed(5)+"&")+("z="+t.getZoom()+"&t="+t.getMapTypeId()+"&")+("d="+this.dateQueryString()+"&a="+this.option.a+"&")+("c="+this.option.c+"&s="+this.option.s+"&w="+this.option.w+"&")+this.infoView.getQuery()};a.prototype.showInfo=function(t){return this.infoView.showPlace(t)};a.prototype.closeInfo=function(){return this.weatherView.eraseMarker()};return a}();window.WeatherControlView=l}).call(this);(function(){var i,t,e,n,s;s=window.SVGNS;i=DataInfo.WIND_DIRECTION;e=24;t=16;n=function(){n.prototype.createCaption=function(i,n){return $("<span class='popupCaption'>"+n+"</span>").css({top:e+i*t}).appendTo(this.div)};n.prototype.createText=function(i){return $("<span class='popupValue' />").css({top:e+i*t}).appendTo(this.div)};function n(r){var n,t,s,e,i;this.parent=$(r);this.div=$("<div class='popupInfo' />");this.attached=false;this.name=$("<span class='popupPlaceName' />").appendTo(this.div);n=["気温","降水量","風速","風向","日照時間","降雪量","積雪量","緯度","経度","標高"];s=["temp","prec","vel","dir","sun","fall","depth","lat","lon","alt"];for(t=e=0,i=n.length;0<=i?e<i:e>i;t=0<=i?++e:--e){this.createCaption(t,n[t]);this[s[t]]=this.createText(t)}this.attach()}n.prototype.moveTo=function(t,e){this.div.css({left:t,top:e})};n.prototype.setInfo=function(n,e,t){this.name.empty().append(e.name);if(t!=null&&t[1]!=null){this.temp.empty().append(""+t[1].toFixed(1)+" ℃")}else{this.temp.empty().append("---")}if(t!=null&&t[0]!=null){this.prec.empty().append(""+t[0].toFixed(1)+" mm/時")}else{this.prec.empty().append("---")}if(t!=null&&t[2]!=null){this.vel.empty().append(""+t[2].toFixed(1)+" m/s")}else{this.vel.empty().append("---")}if(t!=null&&t[3]!=null){this.dir.empty().append(i[t[3]])}else{this.dir.empty().append("---")}if(t!=null&&t[4]!=null){this.sun.empty().append(""+t[4].toFixed(1)+" 時間")}else{this.sun.empty().append("---")}if(t!=null&&t[5]!=null){this.fall.empty().append(""+t[5]+" cm")}else{this.fall.empty().append("---")}if(t!=null&&t[6]!=null){this.depth.empty().append(""+t[6]+" cm")}else{this.depth.empty().append("---")}this.lat.empty().append(e.lat.toFixed(3));this.lon.empty().append(e.lon.toFixed(3));this.alt.empty().append(""+e.alt.toFixed(n>=1e4?1:0)+" m")};n.prototype.attach=function(){if(!this.attached){this.div.appendTo(this.parent);this.attached=true}};n.prototype.detach=function(){if(this.attached){this.div.detach();this.attached=false}};return n}();window.PopupInfoView=n}).call(this);(function(){var h,d,x,u,t,C,e,m,n,l,v,p,c,f,s,y,i,g,r,a,D,o,b,T,M,_,w,L={}.hasOwnProperty,S=function(t,e){for(var i in e){if(L.call(e,i))t[i]=e[i]}function n(){this.constructor=t}n.prototype=e.prototype;t.prototype=new n;t.__super__=e.prototype;return t};r=Math.round;e=window.SVGNS;u=47;m=-71;v=39;x=156;i=function(t){if(t<1){return(""+t).slice(0,5)}else if(t>=100){return""+(t>>0)}else{return(""+t).slice(0,4)}};y=Presentation.scale.dot;c=Presentation.scale.circle;b=Presentation.scale.wind;a=Presentation.scale.size;f=Presentation.fill.dot.regular;s=Presentation.fill.dot.grayed;d={t:Presentation.gradient.temp,p:Presentation.gradient.prec,s:Presentation.gradient.sun,f:Presentation.gradient.fall,d:Presentation.gradient.depth};D=Presentation.path.wind.fill;T=Presentation.path.wind.stroke;w=Presentation.path.wind.strokeWidth;M=Presentation.path.wind.strokeLineCap;_=Presentation.path.wind.strokeLineJoin;o=Presentation.path.wind.render;g=function(){var t,e;e=function(){var e,i;i=[];for(t=e=0;e<16;t=++e){i.push("rotate("+t*22.5+")")}return i}();e.push("rotate(0)");return e}();p=Presentation.animation.interval;h={p:0,t:1,s:4,f:5,d:6};n=[2,3];C=/(\d{4})(\d\d)(\d\d)(\d\d)(\d\d)/;t=Places;l=function(C){S(l,C);function l(e,i,n){var t;l.__super__.constructor.call(this,e,i,u,m,v,x);this.ctl=new WeatherController(this);this.ctlView=new WeatherControlView(this);t=DataInfo.timeMax();if(t.hour()<12){t=t.prevDay()}t=Date.YMDH(t.year(),t.mon(),t.day(),12);this.option={c:"t",s:2,w:2,a:1,d:t};this.processOption(n);return}l.prototype.processOption=function(t){this.ctlView.processOption(t,this.option);if(this.svg!=null){this.updateElements()}this.ctl.setTime(this.option.d)};l.prototype.onAdd=function(){l.__super__.onAdd.apply(this,arguments);this.createElements()};l.prototype.draw=function(){l.__super__.draw.apply(this,arguments);this.updateElements();if(this.popupId!=null){this.updatePopup(this.popupId)}};l.prototype.play=function(){this.ctl.setAnim(p[this.option.a])};l.prototype.stop=function(){this.ctl.setAnim(null)};l.prototype.setOption=function(t,e){if(this.option[t]!==e){this.option[t]=e;if(t==="a"){if(this.ctl.interval()!=null){this.play()}}else{this.updateElements()}}};l.prototype.createElements=function(){var n,s,o,h,a,r,i;this.places=function(){var u;u=[];for(o in t){a=t[o];this.svg.appendChild(s=document.createElementNS(e,"g"));s.appendChild(n=document.createElementNS(e,"circle"));n.setAttribute("cx","0");n.setAttribute("cy","0");n.setAttribute("stroke","none");s.appendChild(i=document.createElementNS(e,"path"));i.setAttribute("fill",D);i.setAttribute("stroke",T);i.setAttribute("stroke-width",w);i.setAttribute("stroke-linecap",M);i.setAttribute("stroke-linejoin",_);s.appendChild(r=document.createElementNS(e,"circle"));r.setAttribute("cx","0");r.setAttribute("cy","0");r.setAttribute("stroke","none");u.push(h={id:o,g:s,circle:n,wind:i,point:r,lat:a.lat,lon:a.lon})}return u}.call(this)};l.prototype.updateElements=function(){var e,u,t,h,l,s,n,d,r,o,g,m,f,p;l=this.getProjection();n=this.origin.x;d=this.origin.y;h=i(y[this.zoom]);u=i(c[this.zoom]*a[this.option.s]);if(this.zoom<10){f=this.places;for(r=0,g=f.length;r<g;r++){t=f[r];s=new google.maps.LatLng(t.lat,t.lon);e=l.fromLatLngToDivPixel(s);if(e.x<n){e.x+=this.pxEarthW}t.g.setAttribute("transform","translate("+(""+(e.x-n)).slice(0,7)+","+(""+(e.y-d)).slice(0,7)+")");t.point.setAttribute("r",h);t.circle.setAttribute("r",u)}}else{p=this.places;for(o=0,m=p.length;o<m;o++){t=p[o];s=new google.maps.LatLng(t.lat,t.lon);e=l.fromLatLngToDivPixel(s);if(e.x<n){e.x+=this.pxEarthW}t.g.setAttribute("transform","translate("+(e.x-n>>0)+","+(e.y-d>>0)+")");t.point.setAttribute("r",h);t.circle.setAttribute("r",u)}}this.updatePoint();this.updateCircle();this.updateWind();this.updateMarker()};l.prototype.update=function(e,t){this.ctlView.update(t);if(this.svg!=null){this.updatePoint();this.updateCircle();this.updateWind();this.updateMarker();if(this.popupId!=null){this.updatePopup(this.popupId)}}};l.prototype.updatePoint=function(){var r,u,c,t,a,e,i,o,d,y,l,p;t=[];u=this.ctl.getData();if(u!=null){if(this.option.s>0){t.push(h[this.option.c])}if(this.option.w>0){t.push(n[0])}}if(t.length===0){l=this.places;for(i=0,d=l.length;i<d;i++){e=l[i];e.point.setAttribute("fill",s)}}else{c=a=t[0];if(t.length===2){a=t[1]}p=this.places;for(o=0,y=p.length;o<y;o++){e=p[o];r=u[e.id];if(r&&(r[c]!=null||r[a]!=null)){e.point.setAttribute("fill",f)}else{e.point.setAttribute("fill",s)}}}};l.prototype.updateCircle=function(){var n,o,p,a,t,e,i,u,l,s,r;if(this.option.s>0&&(o=this.ctl.getData())!=null){a=h[this.option.c];p=d[this.option.c];s=this.places;for(e=0,u=s.length;e<u;e++){t=s[e];n=o[t.id];t.circle.setAttribute("fill",p(n!=null?n[a]:null))}}else{r=this.places;for(i=0,l=r.length;i<l;i++){t=r[i];t.circle.setAttribute("fill","none")}}};l.prototype.updateWind=function(){var t,y,c,e,p,s,l,r,h,u,m,w,f,d;c=o(null);if(this.option.w>0&&(y=this.ctl.getData())!=null){s=i(b[this.zoom]*a[this.option.w]);s="scale("+s+","+s+") ";l=n[0],p=n[1];f=this.places;for(h=0,m=f.length;h<m;h++){e=f[h];r=e.wind;t=y[e.id];if(t!=null&&t[l]!=null&&t[p]!=null){r.setAttribute("d",o(t[l]));r.setAttribute("transform",s+g[t[p]])}else{r.setAttribute("d",c)}}}else{d=this.places;for(u=0,w=d.length;u<w;u++){e=d[u];e.wind.setAttribute("d",c)}}};l.prototype.updateMarker=function(){var e;if(this.markerId!=null){e=t[this.markerId];if(this.marker==null){this.marker=new google.maps.Marker({position:new google.maps.LatLng(e.lat,e.lon),map:this.getMap(),title:e.name})}else{this.marker.setMap(this.getMap());this.marker.setPosition(new google.maps.LatLng(e.lat,e.lon));this.marker.setTitle(e.name)}}else{if(this.marker!=null){this.marker.setMap(null)}}};l.prototype.onClick=function(e){var t;if((t=this.getNearestPlaceId(e))!=null){this.ctlView.showInfo(t);this.markerId=t;this.updateMarker()}};l.prototype.onMouseMove=function(t){this.updatePopup(this.getNearestPlaceId(t))};l.prototype.getNearestPlaceId=function(l){var p,c,y,m,w,h,u,s,a,n,f,d,i,e,g,o,v;n=this.getProjection().fromDivPixelToLatLng(l);a=n.lat();d=LatLonMap[r(a/LatLonMap.step)];if(d==null){return}f=n.lng();s=d[r(f/LatLonMap.step)];if(s==null){return}e=m=null;for(o=0,v=s.length;o<v;o++){u=s[o];i=t[u];c=a-i.lat;y=f-i.lon;p=c*c+y*y;if(e===null||m>p){e=u;m=p}}if(e!=null){i=t[e];n=new google.maps.LatLng(i.lat,i.lon);g=this.getProjection().fromLatLngToDivPixel(n);w=l.x-g.x;h=l.y-g.y;if(w*w+h*h>1600){e=null}}return e};l.prototype.updatePopup=function(e){var s,r,n,i;this.popupId=e;if(e!=null){if(this.popup==null){this.popup=new PopupInfoView(this.div)}this.popup.attach();n=t[e];s=this.ctl.getData()[e];this.popup.setInfo(e,n,s);r=new google.maps.LatLng(n.lat,n.lon);i=this.getProjection().fromLatLngToDivPixel(r);if(i.x<this.origin.x){i+=this.pxEarthW}this.popup.moveTo(i.x-this.origin.x,i.y-this.origin.y)}else if(this.popup!=null){this.popup.detach()}};l.prototype.showMarker=function(t){this.markerId=t;this.updateMarker()};l.prototype.onUpdateData=function(){this.ctlView.onUpdateData()};l.prototype.onHashChange=function(){var t;t=OptionParser.parseHash();this.processGoogleMapsOption(t);this.processOption(t)};l.prototype.processGoogleMapsOption=function(i){var e,t;t=OptionParser.processGoogleMapsOption(i);e=this.getMap();if(t.lat!=null){e.setCenter(new google.maps.LatLng(t.lat,t.lon))}if(t.zoom!=null){e.setZoom(t.zoom)}if(t.type!=null){e.setMapTypeId(t.type)}};return l}(GoogleMapsOverlaySvg);window.WeatherView=l}).call(this);(function(){var e,t,i,n,s;n=OptionParser.parseUrlOption();t=OptionParser.processGoogleMapsOption(n);i=new google.maps.Map(document.getElementById("map"),{minZoom:t.ZoomMin,maxZoom:t.ZoomMax,zoom:t.zoom,mapTypeId:t.type,center:new google.maps.LatLng(t.lat,t.lon),scaleControl:true});if(Modernizr.inlinesvg){s=new WeatherView("map",i,n);window.onhashchange=function(t){return function(){return s.onHashChange()}}(this)}else{e=$("<div class='tenki-alert'> <p>天気データマップの実行にはインラインSVGをサポートするブラウザが必要です(このブラウザでは動作しません)。</p> <p><a id='aboutThisApplication' href='https://github.com/higuma/tenki-data-map'>天気データマップについて...</a></p> </div>")[0];e.index=1;i.controls[google.maps.ControlPosition.TOP_CENTER].push(e)}}).call(this);